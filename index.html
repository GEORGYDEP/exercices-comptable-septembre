<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jeu Comptable POPSY - Version Complète</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM (UMD) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (pour compiler le JSX/TS dans le navigateur) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide React Icons (UMD) -->
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.js"></script>

    <style>
      /* Custom scrollbar for better aesthetics in tables */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #f1f1f1; 
      }
      ::-webkit-scrollbar-thumb {
        background: #cbd5e1; 
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #94a3b8; 
      }
      
      /* Impression : Force l'affichage des couleurs de fond (jaune popsy, etc.) */
      @media print {
        body {
          -webkit-print-color-adjust: exact;
          print-color-adjust: exact;
        }
        /* Cache les éléments inutiles à l'impression */
        .no-print {
          display: none !important;
        }
      }
      
      /* Police manuscrite pour les notes */
      @import url('https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&display=swap');
      .font-handwriting {
        font-family: 'Kalam', cursive;
      }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "lucide-react": "https://aistudiocdn.com/lucide-react@^0.555.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/"
  }
}
</script>
</head>
<body class="bg-gray-50 text-slate-800">
    <div id="root"></div>

    <!-- SCRIPT PRINCIPAL DE L'APPLICATION -->
    <script type="text/babel">
        // --- 1. INITIALISATION DES LIBRAIRIES ---
        const { useState, useEffect, useRef, useMemo } = React;
        
        // Récupération des icônes depuis la librairie globale LucideReact
        const { 
            BookOpen, ChevronRight, ChevronLeft, Eye, RefreshCw, 
            LogIn, AlertCircle, Printer, RotateCcw, Trophy, 
            FileText, List, Grid, Search, X, Plus, Trash2, CheckCircle, HelpCircle 
        } = LucideReact;

        // --- 2. TYPES & ENUMS (Adaptés pour JS) ---
        
        const JournalType = {
            ACHAT: 'ACHAT',
            VENTE: 'VENTE',
            CAISSE: 'CAISSE',
            FINANCIER: 'FINANCIER',
            OD: 'OD'
        };

        // --- 3. CONSTANTES & DONNÉES (CONSTANTS.TS) ---

        const PLAN_COMPTABLE = [
            { account: "1000", label: "Capital souscrit" },
            { account: "1010", label: "Capital non appelé (-)" },
            { account: "1020", label: "Capital amorti" },
            { account: "1100", label: "Primes d'émission" },
            { account: "1200", label: "Plus-values de réévaluation sur im. incorporelles" },
            { account: "1210", label: "Plus-values de réévaluation sur im. corporelles" },
            { account: "1211", label: "Quotité non amortie de la plus-value" },
            { account: "1212", label: "Quotité amortie de la plus-value" },
            { account: "1220", label: "Plus-values de réévaluation sur im. financières" },
            { account: "1230", label: "Plus-values de réévaluation sur stocks" },
            { account: "1240", label: "Reprises de réd. de valeur sur placement de trésor" },
            { account: "1300", label: "Réserve légale" },
            { account: "1310", label: "Réserves indisponibles pour actions propres" },
            { account: "1311", label: "Autres réserves indisponibles" },
            { account: "1320", label: "Réserves immunisées" },
            { account: "1330", label: "Réserves disponibles" },
            { account: "1400", label: "Bénéfice reporté" },
            { account: "1410", label: "Perte reportée (-)" },
            { account: "1500", label: "Subsides en capital" },
            { account: "1600", label: "Provisions pour pensions et obligations similaires" },
            { account: "1610", label: "Provisions pour charges fiscales" },
            { account: "1620", label: "Provisions grosses réparations et gros entretiens" },
            { account: "1630", label: "Provisions pour autres risques et charges" },
            { account: "1680", label: "Impôts différés" },
            { account: "1700", label: "Emprunts subordonnés convertibles" },
            { account: "1701", label: "Emprunts subordonnés non convertibles" },
            { account: "1710", label: "Emprunts obligataires non subordonnés convertibles" },
            { account: "1711", label: "Emprunts obligataires non sub. non convertibles" },
            { account: "1720", label: "Dettes de location-financement et assimilées" },
            { account: "1730", label: "Dettes en compte" },
            { account: "1731", label: "Promesses" },
            { account: "1732", label: "Crédits d'acceptation" },
            { account: "1740", label: "Autres emprunts" },
            { account: "1750", label: "Dettes commerciales (Fournisseurs)" },
            { account: "1751", label: "Effets à payer" },
            { account: "1760", label: "Acomptes reçus sur commandes" },
            { account: "1780", label: "Cautionnements reçus en numéraire" },
            { account: "1790", label: "Dettes diverses" },
            { account: "2000", label: "Frais de constitution et d'augmentation de capital" },
            { account: "2009", label: "Amortissements actés sur frais de constit. (-)" },
            { account: "2010", label: "Frais d'émission d'emprunts" },
            { account: "2020", label: "Autres frais d'établissement" },
            { account: "2029", label: "Amortissements actés s/ autres frais d'établis.(-)" },
            { account: "2040", label: "Frais de restructuration" },
            { account: "2049", label: "Amortissements actés s/ frais de restructurat. (-)" },
            { account: "2100", label: "Frais de recherche et développement" },
            { account: "2109", label: "Amortissements ou réductions de valeur actés (-)" },
            { account: "2110", label: "Concessions, brevets, licences, savoir-faire etc." },
            { account: "2119", label: "Amortissements ou réductions de valeur actés (-)" },
            { account: "2120", label: "Goodwill" },
            { account: "2129", label: "Amort. ou réduc. de valeur actés s/ Goodwill (-)" },
            { account: "2130", label: "Acomptes versés" },
            { account: "2139", label: "Amort. ou réduc. de valeur actés s/ acomptes (-)" },
            { account: "2200", label: "Terrains" },
            { account: "2201", label: "Frais d'acquisition et de mise en état" },
            { account: "2202", label: "Intérêts intercalaires" },
            { account: "2208", label: "Plus-values actées sur terrains" },
            { account: "2209", label: "Amort. ou réduc. de valeur actés s/ terrains (-)" },
            { account: "2210", label: "Constructions" },
            { account: "2218", label: "Plus-values actées sur constructions" },
            { account: "2219", label: "Amortissements actés sur constructions (-)" },
            { account: "2220", label: "Terrains bâtis" },
            { account: "2228", label: "Plus-values actées sur terrain bâtis" },
            { account: "2229", label: "Amortissements actés sur terrain bâtis (-)" },
            { account: "2230", label: "Autres droits réels sur des immeubles" },
            { account: "2238", label: "Plus-values actées autres dr.réel s/ des immeubles" },
            { account: "2239", label: "Amort. actés sur autre droit réel s/ des immeub(-)" },
            { account: "2300", label: "Installations techniques et machines" },
            { account: "2308", label: "Plus-values actées s/ inst.techniques et machines" },
            { account: "2309", label: "Amort. actés sur inst.techniques et machines (-)" },
            { account: "2320", label: "Outillage" },
            { account: "2328", label: "Plus-values actées sur outillage" },
            { account: "2329", label: "Amortissements actés sur outillage (-)" },
            { account: "2400", label: "Mobilier et matériel de bureau" },
            { account: "2408", label: "Plus-values actées sur mobilier et mat. de bureau" },
            { account: "2409", label: "Amortissements sur mobilier et mat. de bureau (-)" },
            { account: "2410", label: "Matériel roulant" },
            { account: "2418", label: "Plus-values actées sur matériel roulant" },
            { account: "2419", label: "Amortissements sur matériel roulant (-)" },
            { account: "2500", label: "Terrains et constructions" },
            { account: "2508", label: "Plus-values actées sur terrains et constructions" },
            { account: "2509", label: "Amortissements sur terrains et constructions (-)" },
            { account: "2510", label: "Installations, machines et outillage" },
            { account: "2518", label: "Plus-values actées s/ instal., mach.et outillage" },
            { account: "2519", label: "Amortissements sur inst.,mach.et outillage (-)" },
            { account: "2520", label: "Mobilier et matériel roulant" },
            { account: "2528", label: "Plus-values actées s/ mobilier et matériel roulant" },
            { account: "2529", label: "Amortissements sur matériel roulant (-)" },
            { account: "2600", label: "Val. d'acquisition des autres immo. corporelles" },
            { account: "2608", label: "Plus-values actées s/ autres immo. corporelles" },
            { account: "2609", label: "Amortissements sur autres immo. corporelles (-)" },
            { account: "2700", label: "Valeur d'acquisition" },
            { account: "2790", label: "Investissements de l'exercice" },
            { account: "2800", label: "Participation dans des entreprises liées" },
            { account: "2801", label: "Montants non appelés (-)" },
            { account: "2808", label: "Plus-values actées" },
            { account: "2809", label: "Réductions de valeur actées (-)" },
            { account: "2810", label: "Créances sur des entreprises liées" },
            { account: "2811", label: "Effets à recevoir" },
            { account: "2812", label: "Titres à revenu fixe" },
            { account: "2817", label: "Créances douteuses" },
            { account: "2819", label: "Réductions de valeur actées (-)" },
            { account: "2820", label: "Participation dans entr. avec lien de particip." },
            { account: "2821", label: "Montants non appelés (-)" },
            { account: "2828", label: "Plus-values actées" },
            { account: "2829", label: "Réductions de valeur actées (-)" },
            { account: "2830", label: "Créances sur entr. avec lien de participation" },
            { account: "2831", label: "Effets à recevoir" },
            { account: "2832", label: "Titres à revenu fixe" },
            { account: "2837", label: "Créances douteuses" },
            { account: "2838", label: "Plus-values actées" },
            { account: "2839", label: "Réductions de valeur actées (-)" },
            { account: "2840", label: "Autres actions et parts" },
            { account: "2841", label: "Montants non appelés (-)" },
            { account: "2848", label: "Plus-values actées" },
            { account: "2849", label: "Réductions de valeur actées (-)" },
            { account: "2850", label: "Autres créances" },
            { account: "2851", label: "Effets à recevoir" },
            { account: "2852", label: "Titres à revenu fixe" },
            { account: "2857", label: "Créances douteuses" },
            { account: "2859", label: "Réductions de valeur actées (-)" },
            { account: "2880", label: "Cautionnements versés en numéraire" },
            { account: "2900", label: "Créances commerciales" },
            { account: "2901", label: "Effets à recevoir" },
            { account: "2906", label: "Acomptes versés" },
            { account: "2907", label: "Créances douteuses" },
            { account: "2909", label: "Réductions de valeur actées (-)" },
            { account: "2910", label: "Autres créances" },
            { account: "2911", label: "Effets à recevoir" },
            { account: "2917", label: "Créances douteuses" },
            { account: "2919", label: "Réductions de valeur actées (-)" },
            { account: "3000", label: "Valeur d'acquisition - matières premières" },
            { account: "3090", label: "Réductions de valeur actées (-)" },
            { account: "3100", label: "Valeur d'acquisition - fournitures" },
            { account: "3190", label: "Réductions de valeur actées (-)" },
            { account: "3200", label: "Valeur d'acquisition - En-cours de fabrication" },
            { account: "3290", label: "Réductions de valeur actées (-)" },
            { account: "3300", label: "Valeur d'acquisition - Produits finis" },
            { account: "3390", label: "Réductions de valeur actées (-)" },
            { account: "3400", label: "Valeur d'acquisition - Marchandises" },
            { account: "3490", label: "Réductions de valeur actées (-)" },
            { account: "3500", label: "Valeur d'acquisition - Imm. destinés à la vente" },
            { account: "3590", label: "Réductions de valeur actées (-)" },
            { account: "3600", label: "Acomptes versés" },
            { account: "3690", label: "Réductions de valeur actées (-)" },
            { account: "3700", label: "Valeur d'acquisition - Comm.en cours d'exécution" },
            { account: "3710", label: "Bénéfice pris en compte" },
            { account: "3790", label: "Réductions de valeur actées (-)" },
            { account: "4000", label: "Clients" },
            { account: "4010", label: "Effets à recevoir" },
            { account: "4011", label: "Effets remis à l'encaissement" },
            { account: "4012", label: "Effets remis à l'escompte" },
            { account: "4040", label: "Produits à recevoir" },
            { account: "4050", label: "Créances pour emballages à rendre" },
            { account: "4051", label: "Fournisseurs débiteurs" },
            { account: "4052", label: "Factures à étalir" },
            { account: "4060", label: "Acomptes versés" },
            { account: "4070", label: "Créances douteuses" },
            { account: "4090", label: "Réductions de valeur actées (-)" },
            { account: "4100", label: "Capital appelé, non versé (Appels de fonds)" },
            { account: "4101", label: "Actionnaires défaillants" },
            { account: "4110", label: "T.V.A. à récupérer sur achat" },
            { account: "4111", label: "T.V.A. déductible intracommunautaire" },
            { account: "4114", label: "T.V.A. à récupérer pour régularisation s/ NCV" },
            { account: "4115", label: "T.V.A. déductible import + report" },
            { account: "4117", label: "T.V.A. sur Acomptes versés" },
            { account: "4119", label: "Compte Courant de l'administration T.V.A." },
            { account: "4120", label: "Impôts belges sur le résultat" },
            { account: "4125", label: "Autres impôts et taxes belges" },
            { account: "4128", label: "Impôts et taxes étrangers" },
            { account: "4140", label: "Produits à recevoir" },
            { account: "4160", label: "Créances diverses" },
            { account: "4170", label: "Créances douteuses" },
            { account: "4180", label: "Cautionnements versés en numéraire" },
            { account: "4190", label: "Réductions de valeur actées (-)" },
            { account: "4200", label: "Emprunts subordonnés convertibles" },
            { account: "4201", label: "Emprunts subordonnés non convertibles" },
            { account: "4210", label: "Emprunts obligataires non subordonnés convertibles" },
            { account: "4211", label: "Emprunts obligataires non subor. non convertibles" },
            { account: "4220", label: "Dettes de location - financement et assimilées" },
            { account: "4230", label: "Etablissement de crédit (Dette en compte)" },
            { account: "4231", label: "Promesses" },
            { account: "4232", label: "Crédits d'acceptation" },
            { account: "4240", label: "Autres emprunts" },
            { account: "4250", label: "Fournisseurs" },
            { account: "4251", label: "Effets à payer" },
            { account: "4260", label: "Acomptes reçus sur commandes" },
            { account: "4280", label: "Cautionnements reçus en numéraire" },
            { account: "4290", label: "Dettes diverses" },
            { account: "4300", label: "Établis. de crédit - emprunts en cpte à terme fixe" },
            { account: "4310", label: "Établissements de crédit - promesses" },
            { account: "4320", label: "Établissements de crédit - crédits d'acceptation" },
            { account: "4330", label: "Établissements de crédit - dettes en cpte courant" },
            { account: "4340", label: "Warrants à payer" },
            { account: "4390", label: "Autres emprunts" },
            { account: "4400", label: "Fournisseurs" },
            { account: "4410", label: "Effets à payer" },
            { account: "4440", label: "Factures à recevoir" },
            { account: "4450", label: "Dettes pour emballages consignés" },
            { account: "4451", label: "Clients créditeurs" },
            { account: "4452", label: "Notes de crédit à établir" },
            { account: "4500", label: "Impôts belges sur le résultat" },
            { account: "4505", label: "Autres impôts et taxes belges" },
            { account: "4508", label: "Impôts et taxes étrangers" },
            { account: "4510", label: "T.V.A. à payer s/ ventes & prestations de services" },
            { account: "4511", label: "T.V.A. à payer intracommunautaire" },
            { account: "4512", label: "T.V.A. à payer import + report" },
            { account: "4513", label: "T.V.A. due (par le cocontractant) sur trav. immob." },
            { account: "4514", label: "T.V.A. due pour régularisations s/ NCA" },
            { account: "4519", label: "Compte courant de l'administration T.V.A." },
            { account: "4520", label: "Impôts belges sur le résultat" },
            { account: "4525", label: "Autres impôts et taxes belges" },
            { account: "4528", label: "Impôts et taxes étrangers" },
            { account: "4530", label: "Précompte professionnel retenu" },
            { account: "4531", label: "Précompte mobilier retenu" },
            { account: "4540", label: "O.N.S.S." },
            { account: "4550", label: "Rémunérations" },
            { account: "4560", label: "Pécule de vacances employés - provisions" },
            { account: "4590", label: "Autres dettes sociales" },
            { account: "4600", label: "Acomptes reçus sur commandes" },
            { account: "4700", label: "Dividendes et tantièmes d'exercices antérieurs" },
            { account: "4710", label: "Dividendes de l'exercice" },
            { account: "4720", label: "Tantièmes de l'exercice" },
            { account: "4730", label: "Autres allocataires" },
            { account: "4740", label: "Actions à rembourser" },
            { account: "4800", label: "Obligations et coupons échus" },
            { account: "4810", label: "Versements anticipés sur capital non-appelé" },
            { account: "4880", label: "Cautionnements reçus en numéraire" },
            { account: "4890", label: "Autres dettes diverses" },
            { account: "4900", label: "Charges à reporter" },
            { account: "4910", label: "Produits acquis" },
            { account: "4920", label: "Charges à imputer" },
            { account: "4930", label: "Produits à reporter" },
            { account: "4960", label: "Ecarts défavorables de conversion des devises" },
            { account: "4970", label: "Ecarts favorables de conversion des devises" },
            { account: "4990", label: "Comptes d'attente" },
            { account: "5000", label: "Valeur d'acquisition - Actions propres" },
            { account: "5100", label: "Valeur d'acquisition - Actions et parts" },
            { account: "5110", label: "Montants non appelés (-)" },
            { account: "5190", label: "Réductions de valeur actées (-)" },
            { account: "5200", label: "Valeur d'acquisition - Titres à revenu fixe" },
            { account: "5290", label: "Réductions de valeur actées (-)" },
            { account: "5300", label: "Dépôts à terme - De plus d'un an" },
            { account: "5310", label: "Dépôts à terme - De + d'un mois et à un an au plus" },
            { account: "5320", label: "Dépôts à terme - D'un mois au plus" },
            { account: "5390", label: "Réductions de valeur actées (-)" },
            { account: "5400", label: "Valeurs échues à l'encaissement" },
            { account: "5500", label: "Banques - compte courant" },
            { account: "5501", label: "Banques - chèques émis" },
            { account: "5509", label: "Banques - réductions de valeur actées (-)" },
            { account: "5600", label: "Compte courant" },
            { account: "5610", label: "Chèques émis (-)" },
            { account: "5700", label: "Caisses - espèces - EUR" },
            { account: "5780", label: "Caisses - timbres - EUR" },
            { account: "5800", label: "Virements internes" },
            { account: "6000", label: "Achats de matières premières" },
            { account: "6010", label: "Achats de fournitures" },
            { account: "6020", label: "Achats de services, travaux et études" },
            { account: "6030", label: "Sous-traitances générales" },
            { account: "6040", label: "Achats de marchandises" },
            { account: "6050", label: "Achats d'immeubles destinés à la vente" },
            { account: "6080", label: "Remises, ristournes et rabais obtenus (-)" },
            { account: "6090", label: "Variation des stocks de matières premières" },
            { account: "6091", label: "Variation des stocks de fournitures" },
            { account: "6094", label: "Variation des stocks de marchandises" },
            { account: "6095", label: "Var. des stocks d'imm. achetés destinés à la vente" },
            { account: "6100", label: "Charges locatives terrains" },
            { account: "6101", label: "Charges locatives constructions" },
            { account: "6102", label: "Charges locatives machines, matériel, outillage" },
            { account: "6103", label: "Charges locatives matériel roulant (voitures etc.)" },
            { account: "6104", label: "Charges locatives matériel roulant (utilitaires)" },
            { account: "6105", label: "Entretien et réparations - terrains" },
            { account: "6106", label: "Entretien et réparations - constructions" },
            { account: "6107", label: "Entretien et réparations - machines et outillage" },
            { account: "6108", label: "Entretien et réparations - matériel roulant (voit)" },
            { account: "6109", label: "Entretien et réparations - matériel roulant (util)" },
            { account: "6110", label: "Fournitures de bureau et imprimés" },
            { account: "6111", label: "Livres, prospectus et documentation" },
            { account: "6112", label: "Petit matériel" },
            { account: "6113", label: "Produits d'entretien" },
            { account: "6114", label: "Produits de consommation non repris en 60" },
            { account: "6115", label: "Consommation eau" },
            { account: "6116", label: "Consommation gaz" },
            { account: "6117", label: "Consommation électricité" },
            { account: "6118", label: "Consommation mazout" },
            { account: "6120", label: "Secrétariats sociaux" },
            { account: "6121", label: "Prestations informatives" },
            { account: "6122", label: "Services factors" },
            { account: "6123", label: "Bureaux d'études" },
            { account: "6124", label: "Organismes financiers" },
            { account: "6125", label: "Contrôle technique (voitures, etc.)" },
            { account: "6126", label: "Contrôle technique (utilitaires)" },
            { account: "6127", label: "Redevances et royalties sur brevets" },
            { account: "6128", label: "Redevances et royalties sur licences" },
            { account: "6130", label: "Assurance incendie" },
            { account: "6131", label: "Assurance vol" },
            { account: "6132", label: "Assurance perte de bénéfice" },
            { account: "6133", label: "Assurance tempête, grêle, intempéries" },
            { account: "6134", label: "Assurance matériel roulant (voitures)" },
            { account: "6135", label: "Assurance matériel roulant (utilitaires)" },
            { account: "6136", label: "Assurance responsabilité risques civils" },
            { account: "6137", label: "Assurance responsabilité risques professionnels" },
            { account: "6138", label: "Assurance transport de marchandises" },
            { account: "6139", label: "Assurance crédit" },
            { account: "6140", label: "Transport sur vente (opération générale)" },
            { account: "6141", label: "Transport maritime" },
            { account: "6142", label: "Transport voie d'eau" },
            { account: "6143", label: "Transport ferroviaire" },
            { account: "6144", label: "Transport par route" },
            { account: "6145", label: "Transport par air" },
            { account: "6146", label: "Autres frais de transport" },
            { account: "6147", label: "Transport à l'intérieur de l'entreprise" },
            { account: "6148", label: "Prestation d'appareils de levage" },
            { account: "6149", label: "Transport en dehors de l'entreprise" },
            { account: "6150", label: "Commissions sur ventes" },
            { account: "6151", label: "Commissions sur achats" },
            { account: "6152", label: "Honoraires comptables" },
            { account: "6153", label: "Honoraires architectes" },
            { account: "6154", label: "Honoraires médecins" },
            { account: "6155", label: "Honoraires vétérinaires" },
            { account: "6156", label: "Honoraires experts" },
            { account: "6157", label: "Honoraires avocats" },
            { account: "6160", label: "Frais postaux" },
            { account: "6161", label: "Frais de port" },
            { account: "6162", label: "Téléphone, GSM" },
            { account: "6163", label: "Télex, fax, Internet" },
            { account: "6165", label: "Frais de déplacement (partie carburant)" },
            { account: "6166", label: "Frais de déplacement (autres frais)" },
            { account: "6167", label: "Frais de déplacement à l'étranger" },
            { account: "6168", label: "Frais de réception limités" },
            { account: "6169", label: "Frais de réception non limités" },
            { account: "6170", label: "Personnes intérimaires" },
            { account: "6171", label: "Personnes mises à disposition" },
            { account: "6180", label: "Rémunérations, primes, pensions de retraite etc." },
            { account: "6190", label: "Publicité et annonces" },
            { account: "6191", label: "Affiches, imprimés, catalogues, échantillons etc." },
            { account: "6192", label: "Participation aux foires, expositions, missions" },
            { account: "6193", label: "Frais d'étalage de démonstration" },
            { account: "6194", label: "Cadeaux et fleurs limités" },
            { account: "6195", label: "Cadeaux et fleurs non limités" },
            { account: "6196", label: "Cotisations" },
            { account: "6197", label: "Dons et libéralités" },
            { account: "6200", label: "Rémunérations des dirigeants d'entreprise" },
            { account: "6201", label: "Personnel de direction - temps plein" },
            { account: "6202", label: "Personnel de direction - temps partiel" },
            { account: "6203", label: "Personnel employé - administratif à temps plein" },
            { account: "6204", label: "Personnel employé - administratif à temps partiel" },
            { account: "6205", label: "Personnel ouvrier à temps plein" },
            { account: "6206", label: "Personnel ouvrier à temps partiel" },
            { account: "6207", label: "Autres membres du personnel" },
            { account: "6210", label: "Cotisations patronales d'assurances sociales" },
            { account: "6220", label: "Primes patronales pour assurances extra-légales" },
            { account: "6230", label: "Autres frais de personnel" },
            { account: "6240", label: "Pensions de retraite et de survie admin. et gérant" },
            { account: "6241", label: "Pensions de retraite et de survie personnel" },
            { account: "6250", label: "Dotations" },
            { account: "6251", label: "Utilisations et reprises (-)" },
            { account: "6260", label: "Dotations" },
            { account: "6261", label: "Utilisations et reprises (-)" },
            { account: "6300", label: "Dot. aux amort. sur frais d'établissement" },
            { account: "6301", label: "Dot. aux amort. sur immobilisations incorporelles" },
            { account: "6302", label: "Dot. aux amort. sur immobilisations corporelles" },
            { account: "6308", label: "Dot. aux réduc. de valeur sur immob. incorporelles" },
            { account: "6309", label: "Dot. aux réduc. de valeur sur immob. corporelles" },
            { account: "6310", label: "Dot. aux réductions de valeur sur stocks" },
            { account: "6311", label: "Reprises de réductions de val. sur stocks (-)" },
            { account: "6320", label: "Dot. aux réd. val. sur commandes en cours d'exéc." },
            { account: "6321", label: "Reprises de réd. val. sur com. en cours d'exéc.(-)" },
            { account: "6330", label: "Dot. aux réd. val. sur créanc. com. à plus d'un an" },
            { account: "6331", label: "Reprises de réd. val. sur cr. com. à + d'un an (-)" },
            { account: "6340", label: "Dot. aux réd. val. sur créances à moins d'un an" },
            { account: "6341", label: "Reprises de réd. val. sur cr. com. < un an (-)" },
            { account: "6350", label: "Dotations aux provisions pour pensions" },
            { account: "6351", label: "Utilisations et rep. des prov. pour pensions (-)" },
            { account: "6360", label: "Dot. aux prov. pour grosses réparat. & entretiens" },
            { account: "6361", label: "Util.&rep.des prov.pour grosses répar.& entret.(-)" },
            { account: "6370", label: "Dot. aux provisions pour autres risques et charges" },
            { account: "6371", label: "Util.&rep.des prov. pr autres risques et charg (-)" },
            { account: "6400", label: "Charges fiscales d'exploitation" },
            { account: "6405", label: "Droits d'enregistrement et publication légale" },
            { account: "6410", label: "Moins-values sur réal. courantes d'immob. corp." },
            { account: "6420", label: "Moins-values sur réal. de créances commerciales" },
            { account: "6430", label: "Charges d'exploitation diverses" },
            { account: "6490", label: "Charg.d'expl.portée à l'actif (fr.restructur.) (-)" },
            { account: "6500", label: "Intérêts, commissions - frais afférents aux dettes" },
            { account: "6501", label: "Amort.des frais d'émis.d'emprunts & primes de remb" },
            { account: "6502", label: "Autres charges des dettes" },
            { account: "6503", label: "Intérêts intercalaires portés à l'actif (-)" },
            { account: "6510", label: "Dotations aux réd. val. sur actifs circulants" },
            { account: "6511", label: "Reprises de réd. de val. sur actifs circulants (-)" },
            { account: "6520", label: "Moins-values sur réalisation d'actifs circulants" },
            { account: "6530", label: "Charges d'escompte de créances" },
            { account: "6540", label: "Différences de change" },
            { account: "6550", label: "Écarts de conversion des devises" },
            { account: "6560", label: "Dotations aux provisions à caractère financier" },
            { account: "6561", label: "Utilisations et repr. de prov. à caract. fin. (-)" },
            { account: "6570", label: "Frais d'acquisition et de vente de titres" },
            { account: "6580", label: "Frais de banque et de règlement" },
            { account: "6590", label: "Charges financières diverses" },
            { account: "6600", label: "Dot. aux amort. except. s/ frais d'établissement" },
            { account: "6601", label: "Dot. aux amort. except. s/ immo. Incorp." },
            { account: "6602", label: "Dot. aux amort. except. s/ immo. Corp." },
            { account: "6610", label: "Dot. aux réd. val. sur immo. financières" },
            { account: "6620", label: "Dot. aux prov. pour risques et charges exception." },
            { account: "6621", label: "Util. de prov. pour risques et charges except. (-)" },
            { account: "6630", label: "Moins-values sur réalisation d'actifs immobilisés" },
            { account: "6640", label: "Autres charges exceptionnelles" },
            { account: "6690", label: "Charges excep. portées à l'actif (fr.restruc) (-)" },
            { account: "6700", label: "Impôts ou précomptes dus ou versés" },
            { account: "6701", label: "Exc.de vers.d'imp. & de préc.portés à l'actif (-)" },
            { account: "6702", label: "Charges fiscales estimées" },
            { account: "6710", label: "Suppléments d'impôts dus ou versés" },
            { account: "6711", label: "Suppléments d'impôts estimés" },
            { account: "6712", label: "Provisions fiscales constituées" },
            { account: "6713", label: "Impôts contestés (-)" },
            { account: "6720", label: "Impôts étrangers sur le résultat de l'exercice" },
            { account: "6730", label: "Impôts étrangers sur le résultat d'ex. antérieurs" },
            { account: "6800", label: "Transferts aux impôts différés" },
            { account: "6890", label: "Transferts aux réserves immunisées" },
            { account: "6900", label: "Perte reportée de l'exercice précédent" },
            { account: "6910", label: "Affectations au capital et à la prime d'émission" },
            { account: "6920", label: "Dotation à la réserve légale" },
            { account: "6921", label: "Dotation aux autres réserves" },
            { account: "6930", label: "Bénéfice à reporter" },
            { account: "6940", label: "Rémunération du capital" },
            { account: "6950", label: "Administrateurs ou gérants" },
            { account: "6960", label: "Autres allocataires" },
            { account: "6970", label: "Actions à rembourser" },
            { account: "7000", label: "Ventes de marchandises" },
            { account: "7010", label: "Ventes de produits finis" },
            { account: "7020", label: "Ventes d'immeubles acquis en vue de leur revente" },
            { account: "7030", label: "Ventes sur commandes" },
            { account: "7040", label: "Ventes d'emballages récupérables" },
            { account: "7070", label: "Prestations de services" },
            { account: "7080", label: "Remises, ristournes et rabais accordés (-)" },
            { account: "7120", label: "Des en-cours de fabrication" },
            { account: "7130", label: "Des produits finis" },
            { account: "7150", label: "Des immeubles construits destinés à la vente" },
            { account: "7170", label: "Des commandes en cours d'exécution" },
            { account: "7171", label: "Bénéfice pris en compte des comm.en cours d'ex." },
            { account: "7200", label: "Production immobilisée" },
            { account: "7400", label: "Subsides d'exploitation et montants compensatoires" },
            { account: "7410", label: "Plus-values sur réal. courantes d'immo. corporel." },
            { account: "7420", label: "Plus-values sur réal. de créances commerciales" },
            { account: "7430", label: "Commissions et courtages" },
            { account: "7440", label: "Prestations de services" },
            { account: "7450", label: "Redevances pour brevets et licences" },
            { account: "7460", label: "Revenus des immeubles" },
            { account: "7470", label: "Revenus d'autres locations" },
            { account: "7480", label: "Récupérations de frais auprès de tiers" },
            { account: "7490", label: "Produits d'exploitation divers" },
            { account: "7500", label: "Produits des immobilisations financières" },
            { account: "7510", label: "Produits des actifs circulants" },
            { account: "7520", label: "Plus-values sur réalisation d'actifs circulants" },
            { account: "7530", label: "Subsides en capital et en intérêts" },
            { account: "7540", label: "Différences de change" },
            { account: "7550", label: "Écarts de conversion des devises" },
            { account: "7560", label: "Escomptes obtenus des fournisseurs" },
            { account: "7570", label: "Écarts de paiement" },
            { account: "7580", label: "Récupérations de frais auprès de tiers" },
            { account: "7590", label: "Produits financiers divers" },
            { account: "7600", label: "Rep.d'amort. & de réd.val. sur immo. incorporelles" },
            { account: "7601", label: "Rep.d'amort. & de réd.val. sur immo. corporelles" },
            { account: "7610", label: "Reprises de réd. de valeur sur immo. financières" },
            { account: "7620", label: "Reprises de prov. pour risques et charges except." },
            { account: "7630", label: "Plus-values sur réalisation d'actifs immobilisés" },
            { account: "7640", label: "Autres produits exceptionnels" },
            { account: "7710", label: "Régularisation d'impôts dus ou versés" },
            { account: "7711", label: "Régularisation d'impôts estimés" },
            { account: "7712", label: "Reprises de provisions fiscales" },
            { account: "7730", label: "Impôts étrangers sur le résultat" },
            { account: "7800", label: "Prélèvements sur les impôts différés" },
            { account: "7890", label: "Prélèvements sur réserves immunisées" },
            { account: "7900", label: "Bénéfice reporté de l'exercice précédent" },
            { account: "7910", label: "Prélèvement sur le capital & les primes d'émission" },
            { account: "7920", label: "Prélèvement sur les réserves" },
            { account: "7930", label: "Perte à reporter" },
            { account: "7940", label: "Intervention d'associés dans la perte" },
        ];

        const DECLARATION_TVA = {
            cadreII: [
                { code: "01", label: "6%" },
                { code: "02", label: "12%" },
                { code: "03", label: "21%" },
                { code: "45", label: "COCONTRACTANT" },
                { code: "46", label: "INTRACOMMUNAUTAIRE" },
                { code: "47", label: "EXPORTATION" },
                { code: "48", label: "NC s/Ventes IC" },
                { code: "49", label: "NC s/Autres" }
            ],
            cadreIII: [
                { code: "81", label: "Marchandises, matières premières" },
                { code: "82", label: "SBD" },
                { code: "83", label: "Investissements" },
                { code: "84", label: "NC s/IC" },
                { code: "85", label: "NC autres" },
                { code: "86", label: "Achats IC" },
                { code: "87", label: "Achats Cocontractant (+ PS intracommunautaire)" }
            ],
            cadreIV: [
                { code: "54", label: "TVA s/ventes" },
                { code: "55", label: "TVA IC" },
                { code: "56", label: "TVA Cocontractant" },
                { code: "57", label: "TVA Import" },
                { code: "63", label: "NC s/achats" },
                { code: "xx", label: "TOTAL" }
            ],
            cadreV: [
                { code: "59", label: "TVA déductible (s/achats)" },
                { code: "64", label: "TVA s/NC s/ventes" },
                { code: "YY", label: "TOTAL" }
            ],
            cadreVI: [
                { code: "71", label: "TVA due à l'état (à payer)" },
                { code: "72", label: "TVA due par l'état (à récupérer)" }
            ]
        };

        const CODES_POPSY = {
            achats: [
                { code: "6CM", tva: "6%", label: "Marchandises Cocontractant" },
                { code: "6CS", tva: "6%", label: "Services Cocontractant" },
                { code: "6CV", tva: "6%", label: "Investissements Cocontractant" },
                { code: "6IM", tva: "6%", label: "Marchandises Intracommunautaires" },
                { code: "6IS", tva: "6%", label: "Services Intracommunautaires" },
                { code: "6IV", tva: "6%", label: "Investissements Intracommunautaires" },
                { code: "6M", tva: "6%", label: "Marchandises" },
                { code: "6S", tva: "6%", label: "Services" },
                { code: "6V", tva: "6%", label: "Investissements" },
                { code: "6XM", tva: "6%", label: "Marchandises Importations" },
                { code: "6XS", tva: "6%", label: "Services Importations" },
                { code: "6XV", tva: "6%", label: "Investissements Importations" },
                { code: "21CM", tva: "21%", label: "Marchandises Cocontractant" },
                { code: "21CS", tva: "21%", label: "Services Cocontractant" },
                { code: "21CV", tva: "21%", label: "Investissements Cocontractant" },
                { code: "21IM", tva: "21%", label: "Marchandises Intracommunautaires" },
                { code: "21IS", tva: "21%", label: "Services Intracommunautaires" },
                { code: "21IV", tva: "21%", label: "Investissements Intracommunautaires" },
                { code: "21M", tva: "21%", label: "Marchandises - 60" },
                { code: "21S", tva: "21%", label: "Services - 61" },
                { code: "21V", tva: "21%", label: "Investissements - 2" },
                { code: "21XM", tva: "21%", label: "Marchandises Importations" },
                { code: "21XS", tva: "21%", label: "Services Importations" },
                { code: "21XV", tva: "21%", label: "Investissements Importations" }
            ],
            ventes: [
                { code: "0", tva: "0%", label: "TVA 0%" },
                { code: "6", tva: "6%", label: "TVA 6%" },
                { code: "12", tva: "12%", label: "TVA 12%" },
                { code: "21", tva: "21%", label: "TVA 21%" },
                { code: "C0", tva: "0%", label: "TVA 0% Cocontractant" },
                { code: "EX", tva: "", label: "Exonéré" },
                { code: "I0", tva: "0%", label: "TVA 0% Intracommunautaire" },
                { code: "X0", tva: "0%", label: "TVA 0% Exportations" }
            ],
            divers: [
                { code: "21ND", label: "TVA SUR FRAIS DE VOITURE (50% TVA RECUP) = sbd (case 82 décl tva)" },
                { code: "EX", label: "Pour les loyers, timbres, taxes, assurances et emballages consignés" }
            ]
        };

        const LEVELS = [
          // --- NIVEAUX D'INTRODUCTION (1-4) ---
          {
            id: 1,
            title: "Exercice de réouverture",
            description: "Comptabilisez l'écriture de réouverture de l'exercice au 1er janvier.",
            documents: [
              {
                type: 'NOTE',
                title: "Énoncé : Réouverture",
                content: {
                  text: "Dans cet exercice de rappel, tu représentes la société OUTISUD.\n\nAu 1er janvier N, la société possède un montant de 10.000 Eur en banque et de 5.000 Eur en caisse.\n\nComptabilise l’écriture de réouverture des comptes au 1er janvier N dans le journal des Opérations Diverses."
                }
              }
            ],
            requiredJournals: [
              {
                type: JournalType.OD,
                defaultDate: "01/01/N",
                solution: [
                  { id: 's1', accountNumber: '5500', declTva: '', codePopsy: '', label: 'BANQUE', debit: '10.000', credit: '' },
                  { id: 's2', accountNumber: '5700', declTva: '', codePopsy: '', label: 'CAISSE', debit: '5.000', credit: '' },
                  { id: 's3', accountNumber: '1000', declTva: '', codePopsy: '', label: 'CAPITAL', debit: '', credit: '15.000' },
                ]
              }
            ]
          },
          {
            id: 2,
            title: "Facture 100 - Achat & Caisse",
            description: "Enregistrez la facture d'achat et son paiement en liquide.",
            documents: [
              {
                type: 'INVOICE',
                title: "Facture 100",
                content: {
                  sender: { name: "ALL SIGN", address: ["rue de l'Ecole 2", "7080 FRAMERIES"], vat: "BE 0424.850.991" },
                  receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
                  details: { number: "100", date: "01/06/XX", paymentInfo: "Paiement au grand comptant" },
                  lines: [{ qty: 150, desc: "Produit B", pu: "10", total: "1500" }, { qty: "", desc: "RRR", pu: "", total: "-150" }],
                  totals: {
                    bases: [{ rate: "6%", base: "", tax: "" }, { rate: "21%", base: "1350", tax: "283,50" }],
                    totalExcl: "1350,00",
                    totalVat: "283,50",
                    toPay: "1633,50"
                  }
                }
              }
            ],
            requiredJournals: [
              {
                type: JournalType.ACHAT,
                defaultDate: "01/06/XX",
                solution: [
                  { id: 's1', accountNumber: '6040', declTva: '81', codePopsy: '21M', label: '', debit: '1350', credit: '' },
                  { id: 's2', accountNumber: '4110', declTva: '59', codePopsy: '', label: '', debit: '283.50', credit: '' },
                  { id: 's3', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '', credit: '1633,50' },
                ]
              },
              {
                type: JournalType.CAISSE,
                defaultDate: "01/06/XX",
                solution: [
                  { id: 's1', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '1633,50', credit: '' },
                  { id: 's2', accountNumber: '5700', declTva: '', codePopsy: '', label: '', debit: '', credit: '1633,50' },
                ]
              }
            ]
          },
          {
            id: 3,
            title: "Facture 823 - Chèque",
            description: "Enregistrez la facture d'achat, le paiement par chèque (OD) et l'extrait bancaire.",
            documents: [
              {
                type: 'INVOICE',
                title: "Facture 823",
                content: {
                  sender: { name: "ELECTRABEL", address: ["rue Branche 45", "6687 BERTOGNE"], vat: "BE 0895 538 345" },
                  receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
                  details: { number: "823", date: "06/06/XX", paymentInfo: "A payer dans les 10 jours" },
                  lines: [{ qty: "05/XX", desc: "Facture complémentaire", pu: "", total: "3000,00" }],
                  totals: {
                    bases: [{ rate: "21%", base: "3000,00", tax: "630,00" }],
                    totalExcl: "3000,00",
                    totalVat: "630,00",
                    toPay: "3630,00"
                  }
                }
              },
              { type: 'NOTE', title: "Info Paiement", content: { text: "Reçu chèque no 154333 pour un montant de 3630 €\nPour acquis" } },
              {
                type: 'BANK_EXTRACT', title: "Extrait de banque n°31",
                content: {
                  account: "068-4567890-02", prevDate: "01/06/XX", prevBalance: "10.000,00",
                  transactions: [{ date: "10/06/XX", desc: "Chèque no 154333", amount: "-3.630,00" }],
                  newDate: "10/06/XX", newBalance: "6.370,00"
                }
              }
            ],
            requiredJournals: [
              {
                type: JournalType.ACHAT, defaultDate: "06/06/XX",
                solution: [
                  { id: 's1', accountNumber: '6117', declTva: '82', codePopsy: '21S', label: '', debit: '3000', credit: '' },
                  { id: 's2', accountNumber: '4110', declTva: '59', codePopsy: '', label: '', debit: '630', credit: '' },
                  { id: 's3', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '', credit: '3630' },
                ]
              },
              {
                type: JournalType.OD, defaultDate: "06/06/XX",
                solution: [
                  { id: 's1', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '3630', credit: '' },
                  { id: 's2', accountNumber: '5501', declTva: '', codePopsy: '', label: '', debit: '', credit: '3630' },
                ]
              },
              {
                type: JournalType.FINANCIER, defaultDate: "10/06/XX",
                solution: [
                  { id: 's1', accountNumber: '5501', declTva: '', codePopsy: '', label: '', debit: '3630', credit: '' },
                  { id: 's2', accountNumber: '5500', declTva: '', codePopsy: '', label: '', debit: '', credit: '3630' },
                ]
              }
            ]
          },
          {
            id: 4,
            title: "Facture 10 - Virement",
            description: "Enregistrez la facture d'achat de mobilier, le virement papier (OD) et l'extrait bancaire.",
            documents: [
              {
                type: 'INVOICE',
                title: "Facture 10",
                content: {
                  sender: { name: "VOLUME BUREAU SPRL", address: ["rue de la Joie 25", "7080 FRAMERIES"], vat: "BE 0416.295.690" },
                  receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
                  details: { number: "10", date: "16/06/XX", paymentInfo: "A payer avant le 26 du mois" },
                  lines: [{ qty: "1", desc: "Bureau en bois", pu: "5.000,00", total: "5.000,00" }],
                  totals: {
                    bases: [{ rate: "21%", base: "5.000,00", tax: "1.050,00" }],
                    totalExcl: "5.000,00",
                    totalVat: "1.050,00",
                    toPay: "6.050,00"
                  }
                }
              },
              { type: 'NOTE', title: "Action", content: { text: "Vous effectuez un virement papier le jour même (16/06/XX)." } },
              {
                type: 'BANK_EXTRACT', title: "Extrait de banque n°32",
                content: {
                  account: "068-4567890-02", prevDate: "10/06/XX", prevBalance: "6.370,00",
                  transactions: [{ date: "16/06/XX", desc: "Votre Virement", amount: "-6.050,00" }],
                  newDate: "20/06/XX", newBalance: "320,00"
                }
              }
            ],
            requiredJournals: [
              {
                type: JournalType.ACHAT, defaultDate: "16/06/XX",
                solution: [
                  { id: 's1', accountNumber: '2400', declTva: '83', codePopsy: '21V', label: '', debit: '5000', credit: '' },
                  { id: 's2', accountNumber: '4110', declTva: '59', codePopsy: '', label: '', debit: '1050', credit: '' },
                  { id: 's3', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '', credit: '6050' },
                ]
              },
              {
                type: JournalType.OD, defaultDate: "16/06/XX",
                solution: [
                  { id: 's1', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '6050', credit: '' },
                  { id: 's2', accountNumber: '5501', declTva: '', codePopsy: '', label: '', debit: '', credit: '6050' },
                ]
              },
              {
                type: JournalType.FINANCIER, defaultDate: "20/06/XX",
                solution: [
                  { id: 's1', accountNumber: '5501', declTva: '', codePopsy: '', label: '', debit: '6050', credit: '' },
                  { id: 's2', accountNumber: '5500', declTva: '', codePopsy: '', label: '', debit: '', credit: '6050' },
                ]
              }
            ]
          },
          // ... (Les 28 autres exercices suivent)
          // Page 1
  {
    id: 5,
    title: "Ex 1 - Facture Vente 50",
    description: "Vente de marchandises à A.V.I. S.A.",
    documents: [
      {
        type: 'INVOICE',
        title: "Facture 50",
        content: {
          sender: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          receiver: { name: "A.V.I. S.A.", address: ["rue du Collège 5", "5000 NAMUR"], vat: "BE 0895 538 345" },
          details: { number: "50", date: "18/06/XX", paymentInfo: "10 jours nets" },
          lines: [{ qty: 100, desc: "Produit B", pu: "10,00", total: "1.000,00" }],
          totals: { bases: [{ rate: "21%", base: "1000", tax: "210" }], totalExcl: "1000", totalVat: "210", toPay: "1210" }
        }
      },
      {
        type: 'BANK_EXTRACT', title: "Extrait n°33",
        content: {
          account: "068-4567890-02", prevDate: "20/06/XX", prevBalance: "320,00",
          transactions: [{ date: "21/06/XX", desc: "Virement AVI", amount: "1.210,00" }],
          newDate: "25/06/XX", newBalance: "1.530,00"
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.VENTE, defaultDate: "18/06/N",
        solution: [
          { id: 's1', accountNumber: '7000', declTva: '03', codePopsy: '21', label: '', debit: '', credit: '1000' },
          { id: 's2', accountNumber: '4510', declTva: '54', codePopsy: '', label: '', debit: '', credit: '210' },
          { id: 's3', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '1210', credit: '' }
        ]
      },
      {
        type: JournalType.FINANCIER, defaultDate: "25/06/N",
        solution: [
          { id: 's1', accountNumber: '5500', declTva: '', codePopsy: '', label: '', debit: '1210', credit: '' },
          { id: 's2', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '', credit: '1210' }
        ]
      }
    ]
  },
  // Page 2
  {
    id: 6,
    title: "Ex 2 - Facture Vente 51",
    description: "Prestation de service avec RRR.",
    documents: [
      {
        type: 'INVOICE', title: "Facture 51",
        content: {
          sender: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" }, 
          receiver: { name: "A.V.I. S.A.", address: ["rue du Collège 5", "5000 NAMUR"], vat: "BE 0895 538 345" },
          details: { number: "51", date: "20/06/XX", paymentInfo: "10 jours nets" },
          lines: [{ qty: 1, desc: "Prestation de service", pu: "1500", total: "1500" }, { qty: "", desc: "RRR", pu: "", total: "-150" }],
          totals: { bases: [{ rate: "21%", base: "1350", tax: "283,50" }], totalExcl: "1350", totalVat: "283,50", toPay: "1633,50" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.VENTE, defaultDate: "20/06/n",
        solution: [
          { id: 's1', accountNumber: '7070', declTva: '03', codePopsy: '21', label: '', debit: '', credit: '1350' },
          { id: 's2', accountNumber: '4510', declTva: '54', codePopsy: '', label: '', debit: '', credit: '283,50' },
          { id: 's3', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '1633,50', credit: '' }
        ]
      }
    ]
  },
  // Page 3
  {
    id: 7,
    title: "Ex 3 - Achat Intra-comm (Latoure)",
    description: "Acquisition intra-communautaire (France).",
    documents: [
      {
        type: 'INVOICE', title: "Facture 1569",
        content: {
          sender: { name: "LATOURE", address: ["Chée de France 18", "Paris - France"], vat: "FR 12 716 672 051" },
          receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          details: { number: "1569", date: "15/06/XX", paymentInfo: "30 jours nets" },
          lines: [{ qty: 400, desc: "Produit B", pu: "10", total: "4000" }, { qty: "", desc: "RRR", pu: "", total: "-400" }],
          totals: { bases: [], totalExcl: "3600", totalVat: "0", toPay: "3600" }
        }
      },
      { type: 'NOTE', title: "Info", content: { text: "Art 138 par 1 de la directive TVA" } }
    ],
    requiredJournals: [
      {
        type: JournalType.ACHAT, defaultDate: "15/06/n",
        solution: [
          { id: 's1', accountNumber: '6040', declTva: '81+86', codePopsy: '21IM', label: '', debit: '3600', credit: '' },
          { id: 's2', accountNumber: '4110', declTva: '59', codePopsy: '', label: '', debit: '756', credit: '' },
          { id: 's3', accountNumber: '4511', declTva: '55', codePopsy: '', label: 'TVA A PAYER IC', debit: '', credit: '756' },
          { id: 's4', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '', credit: '3600' }
        ]
      }
    ]
  },
  // Page 4
  {
    id: 8,
    title: "Ex 4 - Vente Intra-comm (Latoure)",
    description: "Livraison intra-communautaire (France).",
    documents: [
      {
        type: 'INVOICE', title: "Facture 55",
        content: {
          sender: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          receiver: { name: "LATOURE", address: ["Chée de France 18", "Paris - France"], vat: "FR 12 716 672 051" },
          details: { number: "55", date: "15/06/XX", paymentInfo: "30 jours nets" },
          lines: [{ qty: 400, desc: "Produit B", pu: "10", total: "4000" }, { qty: "", desc: "RRR", pu: "", total: "-400" }],
          totals: { bases: [], totalExcl: "3600", totalVat: "0", toPay: "3600" }
        }
      },
      { type: 'NOTE', title: "Info", content: { text: "Exonération – art 39bis CTVA" } }
    ],
    requiredJournals: [
      {
        type: JournalType.VENTE, defaultDate: "15/06/n",
        solution: [
          { id: 's1', accountNumber: '7000', declTva: '46', codePopsy: 'I0', label: '', debit: '', credit: '3600' },
          { id: 's2', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '3600', credit: '' }
        ]
      }
    ]
  },
  // Page 5
  {
    id: 9,
    title: "Ex 5 - Achat Import (Suisse)",
    description: "Importation de marchandises (Suisse).",
    documents: [
      {
        type: 'INVOICE', title: "Facture 15",
        content: {
          sender: { name: "B.E.I.", address: ["Chemin de Juinville 26", "1216 Cointrin", "Suisse"], vat: "CH 16 672 051" },
          receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          details: { number: "15", date: "25/06/XX", paymentInfo: "30 jours nets" },
          lines: [{ qty: 1, desc: "Produit B", pu: "15.000", total: "15.000" }],
          totals: { bases: [], totalExcl: "15.000", totalVat: "", toPay: "15.000" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.ACHAT, defaultDate: "25/06/n",
        solution: [
          { id: 's1', accountNumber: '6040', declTva: '81+87', codePopsy: '21XM', label: '', debit: '15000', credit: '' },
          { id: 's2', accountNumber: '4110', declTva: '59', codePopsy: '', label: '', debit: '3150', credit: '' },
          { id: 's3', accountNumber: '4512', declTva: '57', codePopsy: '', label: 'TVA A PAYER imp', debit: '', credit: '3150' },
          { id: 's4', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '', credit: '15000' }
        ]
      }
    ]
  },
  // Page 6
  {
    id: 10,
    title: "Ex 6 - Vente Export (Suisse)",
    description: "Exportation de marchandises.",
    documents: [
      {
        type: 'INVOICE', title: "Facture 60",
        content: {
          sender: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          receiver: { name: "B.E.I.", address: ["Chemin de Juinville 26", "1216 Cointrin", "Suisse"], vat: "CH 16 672 051" },
          details: { number: "60", date: "25/06/XX", paymentInfo: "30 jours nets" },
          lines: [{ qty: 1, desc: "Produit B", pu: "15.000", total: "15.000" }],
          totals: { bases: [], totalExcl: "15.000", totalVat: "0", toPay: "15.000" }
        }
      },
      { type: 'NOTE', title: "Info", content: { text: "ART 39 CTVA" } }
    ],
    requiredJournals: [
      {
        type: JournalType.VENTE, defaultDate: "25/06/n",
        solution: [
          { id: 's1', accountNumber: '7000', declTva: '47', codePopsy: 'X0', label: '', debit: '', credit: '15000' },
          { id: 's2', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '15000', credit: '' }
        ]
      }
    ]
  },
  // Page 7
  {
    id: 11,
    title: "Ex 7 - Achat Cocontractant",
    description: "Nettoyage locaux (travaux immobiliers).",
    documents: [
      {
        type: 'INVOICE', title: "Facture 789",
        content: {
          sender: { name: "Cleanup", address: ["Chée de France 18", "6000 Charleroi"], vat: "BE 0424.850.991" },
          receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          details: { number: "789", date: "11/06/XX", paymentInfo: "A payer" },
          lines: [{ qty: 1, desc: "Nettoyage de vos locaux", pu: "750", total: "750" }],
          totals: { bases: [{ rate: "21%", base: "750", tax: "0 (Cocontractant)" }], totalExcl: "750", totalVat: "0", toPay: "750" }
        }
      },
      { type: 'NOTE', title: "Info", content: { text: "Taxe à acquitter par le cocontractant – AUTOLIQUIDATION" } }
    ],
    requiredJournals: [
      {
        type: JournalType.ACHAT, defaultDate: "11/06/n",
        solution: [
          { id: 's1', accountNumber: '6106', declTva: '82+87', codePopsy: '21CS', label: '', debit: '750', credit: '' },
          { id: 's2', accountNumber: '4110', declTva: '59', codePopsy: '', label: '', debit: '157,50', credit: '' },
          { id: 's3', accountNumber: '4513', declTva: '56', codePopsy: '', label: 'TVA A PAYER co', debit: '', credit: '157,50' },
          { id: 's4', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '', credit: '750' }
        ]
      }
    ]
  },
  // Page 8
  {
    id: 12,
    title: "Ex 8 - Vente Cocontractant",
    description: "Vente de services avec report de charge (cocontractant).",
    documents: [
      {
        type: 'INVOICE', title: "Facture 62",
        content: {
          sender: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          receiver: { name: "A.V.I. S.A.", address: ["rue du Collège 5", "5000 NAMUR"], vat: "BE 0895 538 345" },
          details: { number: "62", date: "11/06/XX", paymentInfo: "A payer" },
          lines: [{ qty: 1, desc: "Nettoyage de vos locaux", pu: "750", total: "750" }],
          totals: { bases: [], totalExcl: "750", totalVat: "0", toPay: "750" }
        }
      },
      { type: 'NOTE', title: "Info", content: { text: "Taxe à acquitter par le cocontractant – AUTOLIQUIDATION" } }
    ],
    requiredJournals: [
      {
        type: JournalType.VENTE, defaultDate: "11/06/n",
        solution: [
          { id: 's1', accountNumber: '7070', declTva: '45', codePopsy: 'C0', label: '', debit: '', credit: '750' },
          { id: 's2', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '750', credit: '' }
        ]
      }
    ]
  },
  // Page 9
  {
    id: 13,
    title: "Ex 9 - NC sur Achat",
    description: "Retour de marchandises (Produit B).",
    documents: [
      {
        type: 'INVOICE', title: "NOTE DE CREDIT N°3",
        content: {
          sender: { name: "COTUBEX", address: ["rue des Fabriques 27-31", "1400 NIVELLES"], vat: "BE 0861.775.912" },
          receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          details: { number: "3", date: "20/06/XX", paymentInfo: "Total à rembourser" },
          lines: [{ qty: 600, desc: "Retour produit B", pu: "10", total: "6.000" }],
          totals: { bases: [{ rate: "21%", base: "6000", tax: "1260" }], totalExcl: "6000", totalVat: "1260", toPay: "7260" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.ACHAT, defaultDate: "20/06/n",
        solution: [
          { id: 's1', accountNumber: '6040', declTva: '81(-)+85', codePopsy: '21M', label: '', debit: '', credit: '6000' },
          { id: 's2', accountNumber: '4514', declTva: '63', codePopsy: '', label: '', debit: '', credit: '1260' },
          { id: 's3', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '7260', credit: '' }
        ]
      }
    ]
  },
  // Page 10
  {
    id: 14,
    title: "Ex 10 - NC sur Vente",
    description: "Retour de marchandises de A.V.I.",
    documents: [
      {
        type: 'INVOICE', title: "NOTE DE CREDIT N°20",
        content: {
          sender: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          receiver: { name: "A.V.I. S.A.", address: ["rue du Collège 5", "5000 NAMUR"], vat: "BE 0895 538 345" },
          details: { number: "20", date: "26/06/XX", paymentInfo: "Total à rembourser" },
          lines: [{ qty: 600, desc: "Retour produit B", pu: "10", total: "6000" }],
          totals: { bases: [{ rate: "21%", base: "6000", tax: "1260" }], totalExcl: "6000", totalVat: "1260", toPay: "7260" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.VENTE, defaultDate: "26/06/n",
        solution: [
          { id: 's1', accountNumber: '7000', declTva: '49', codePopsy: '21', label: '', debit: '6000', credit: '' },
          { id: 's2', accountNumber: '4114', declTva: '64', codePopsy: '', label: '', debit: '1260', credit: '' },
          { id: 's3', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '', credit: '7260' }
        ]
      }
    ]
  },
  // Page 11
  {
    id: 15,
    title: "Ex 11 - NC Achat (Remise)",
    description: "Remise exceptionnelle obtenue.",
    documents: [
      {
        type: 'INVOICE', title: "NOTE DE CREDIT N°4",
        content: {
          sender: { name: "COTUBEX", address: ["rue des Fabriques 27-31", "1400 NIVELLES"], vat: "BE 0861.775.912" },
          receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          details: { number: "4", date: "20/06/XX", paymentInfo: "Total à rembourser" },
          lines: [{ qty: 1, desc: "Remise exceptionnelle", pu: "1000", total: "1000" }],
          totals: { bases: [{ rate: "21%", base: "1000", tax: "210" }], totalExcl: "1000", totalVat: "210", toPay: "1210" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.ACHAT, defaultDate: "20/06/n",
        solution: [
          { id: 's1', accountNumber: '6080', declTva: '81(-)+85', codePopsy: '21M', label: '', debit: '', credit: '1000' },
          { id: 's2', accountNumber: '4514', declTva: '63', codePopsy: '', label: '', debit: '', credit: '210' },
          { id: 's3', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '1210', credit: '' }
        ]
      }
    ]
  },
  // Page 12
  {
    id: 16,
    title: "Ex 12 - NC Vente (Remise)",
    description: "Remise exceptionnelle accordée.",
    documents: [
      {
        type: 'INVOICE', title: "NOTE DE CREDIT N°22",
        content: {
          sender: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          receiver: { name: "A.V.I. S.A.", address: ["rue du Collège 5", "5000 NAMUR"], vat: "BE 0895 538 345" },
          details: { number: "22", date: "26/06/XX", paymentInfo: "Total à rembourser" },
          lines: [{ qty: 1, desc: "Remise exceptionnelle", pu: "1000", total: "1000" }],
          totals: { bases: [{ rate: "21%", base: "1000", tax: "210" }], totalExcl: "1000", totalVat: "210", toPay: "1210" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.VENTE, defaultDate: "26/06/n",
        solution: [
          { id: 's1', accountNumber: '7080', declTva: '49', codePopsy: '21', label: '', debit: '1000', credit: '' },
          { id: 's2', accountNumber: '4114', declTva: '64', codePopsy: '', label: '', debit: '210', credit: '' },
          { id: 's3', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '', credit: '1210' }
        ]
      }
    ]
  },
  // Page 13
  {
    id: 17,
    title: "Ex 13 - NC Achat (Emballage)",
    description: "Retour emballages consignés (Achat).",
    documents: [
      {
        type: 'INVOICE', title: "NOTE DE CREDIT N°5",
        content: {
          sender: { name: "COTUBEX", address: ["rue des Fabriques 27-31", "1400 NIVELLES"], vat: "BE 0861.775.912" },
          receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          details: { number: "5", date: "20/06/XX", paymentInfo: "Total à rembourser" },
          lines: [{ qty: 1, desc: "Emballage consignés", pu: "100", total: "100" }],
          totals: { bases: [], totalExcl: "100", totalVat: "0", toPay: "100" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.ACHAT, defaultDate: "20/06/n",
        solution: [
          { id: 's1', accountNumber: '4050', declTva: 'EX', codePopsy: '', label: '', debit: '', credit: '100' },
          { id: 's2', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '100', credit: '' }
        ]
      }
    ]
  },
  // Page 14
  {
    id: 18,
    title: "Ex 14 - NC Vente (Emballage)",
    description: "Retour emballages consignés (Vente).",
    documents: [
      {
        type: 'INVOICE', title: "NOTE DE CREDIT N°26",
        content: {
          sender: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          receiver: { name: "A.V.I. S.A.", address: ["rue du Collège 5", "5000 NAMUR"], vat: "BE 0895 538 345" },
          details: { number: "26", date: "26/06/XX", paymentInfo: "Total à rembourser" },
          lines: [{ qty: 1, desc: "Emballage consignés", pu: "100", total: "100" }],
          totals: { bases: [], totalExcl: "100", totalVat: "0", toPay: "100" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.VENTE, defaultDate: "26/06/n",
        solution: [
          { id: 's1', accountNumber: '4450', declTva: 'EX', codePopsy: '', label: '', debit: '100', credit: '' },
          { id: 's2', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '', credit: '100' }
        ]
      }
    ]
  },
  // Page 15
  {
    id: 19,
    title: "Ex 15 - Achat + Escompte + Paiement",
    description: "Achat avec escompte 2% pour paiement comptant.",
    documents: [
      {
        type: 'INVOICE', title: "Facture 521",
        content: {
          sender: { name: "COTUBEX", address: ["rue des Fabriques 27-31", "1400 NIVELLES"], vat: "BE 0861.775.912" }, 
          receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          details: { number: "521", date: "25/06/XX", paymentInfo: "Escompte 2% à déduire" },
          lines: [{ qty: 150, desc: "Produit B (net 1350)", pu: "", total: "1350" }],
          totals: { bases: [{ rate: "21%", base: "1350", tax: "277,83" }], totalExcl: "1350", totalVat: "277,83", toPay: "1627,83" }
        }
      },
      { type: 'NOTE', title: "Info", content: { text: "Paiement par carte bancaire ce jour." } },
      { type: 'BANK_EXTRACT', title: "Extrait n°34", content: { account: "068-...", transactions: [{ date: "26/06/XX", desc: "Paiement carte", amount: "-1600,83" }] } }
    ],
    requiredJournals: [
      {
        type: JournalType.ACHAT, defaultDate: "25/06/n",
        solution: [
          { id: 's1', accountNumber: '6040', declTva: '81', codePopsy: '21M', label: '', debit: '1350', credit: '' },
          { id: 's2', accountNumber: '4110', declTva: '59', codePopsy: '', label: '', debit: '277,83', credit: '' },
          { id: 's3', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '', credit: '1627,83' }
        ]
      },
      {
        type: JournalType.OD, defaultDate: "25/06/n",
        solution: [
          { id: 's1', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '1627,83', credit: '' },
          { id: 's2', accountNumber: '7560', declTva: '', codePopsy: '', label: '', debit: '', credit: '27' },
          { id: 's3', accountNumber: '5501', declTva: '', codePopsy: '', label: '', debit: '', credit: '1600,83' }
        ]
      },
      {
        type: JournalType.FINANCIER, defaultDate: "30/06/n",
        solution: [
          { id: 's1', accountNumber: '5501', declTva: '', codePopsy: '', label: '', debit: '1600,83', credit: '' },
          { id: 's2', accountNumber: '5500', declTva: '', codePopsy: '', label: '', debit: '', credit: '1600,83' }
        ]
      }
    ]
  },
  // Page 16
  {
    id: 20,
    title: "Ex 16 - Vente + Escompte + Paiement",
    description: "Vente avec escompte 2% pour paiement comptant.",
    documents: [
      {
        type: 'INVOICE', title: "Facture 750",
        content: {
          sender: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" }, 
          receiver: { name: "A.V.I. S.A.", address: ["rue du Collège 5", "5000 NAMUR"], vat: "BE 0895 538 345" },
          details: { number: "750", date: "07/06/XX", paymentInfo: "Escompte 2% à déduire" },
          totals: { bases: [{ rate: "21%", base: "1350", tax: "277,83" }], totalExcl: "1350", totalVat: "277,83", toPay: "1627,83" }
        }
      },
      { type: 'NOTE', title: "Info", content: { text: "Paiement par carte bancaire ce jour." } },
      { type: 'BANK_EXTRACT', title: "Extrait n°35", content: { account: "068-...", transactions: [{ date: "26/06/XX", desc: "Paiement carte", amount: "1600,83" }] } }
    ],
    requiredJournals: [
      {
        type: JournalType.VENTE, defaultDate: "07/06/n",
        solution: [
          { id: 's1', accountNumber: '7000', declTva: '03', codePopsy: '21', label: '', debit: '', credit: '1350' },
          { id: 's2', accountNumber: '4510', declTva: '54', codePopsy: '', label: '', debit: '', credit: '277,83' },
          { id: 's3', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '', credit: '1627,83' }
        ]
      },
      {
        type: JournalType.OD, defaultDate: "07/06/n",
        solution: [
          { id: 's1', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '', credit: '1627,83' },
          { id: 's2', accountNumber: '6530', declTva: '', codePopsy: '', label: '', debit: '27', credit: '' },
          { id: 's3', accountNumber: '5400', declTva: '', codePopsy: '', label: '', debit: '1600,83', credit: '' }
        ]
      },
      {
        type: JournalType.FINANCIER, defaultDate: "26/06/n",
        solution: [
          { id: 's1', accountNumber: '5500', declTva: '', codePopsy: '', label: '', debit: '1600,83', credit: '' },
          { id: 's2', accountNumber: '5400', declTva: '', codePopsy: '', label: '', debit: '', credit: '1600,83' }
        ]
      }
    ]
  },
  // Page 17
  {
    id: 21,
    title: "Ex 17 - Achat Escompte Ferme",
    description: "Escompte ferme déduit directement sur la facture.",
    documents: [
      {
        type: 'INVOICE', title: "Facture 888",
        content: {
          sender: { name: "COTUBEX", address: ["rue des Fabriques 27-31", "1400 NIVELLES"], vat: "BE 0861.775.912" },
          receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          details: { number: "888", date: "30/06/XX" },
          lines: [{ qty: 150, desc: "Produit B", pu: "10", total: "1500" }, { qty: "", desc: "Escompte ferme", pu: "", total: "-27" }],
          totals: { bases: [{ rate: "21%", base: "1323 (Net)", tax: "277,83" }], totalExcl: "1323", totalVat: "277,83", toPay: "1600,83" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.ACHAT, defaultDate: "30/06/n",
        solution: [
          { id: 's1', accountNumber: '6040', declTva: '81', codePopsy: '21M', label: '', debit: '1350', credit: '' },
          { id: 's2', accountNumber: '7560', declTva: '81(-)', codePopsy: '21S', label: '', debit: '', credit: '27' },
          { id: 's3', accountNumber: '4110', declTva: '59', codePopsy: '', label: '', debit: '277,83', credit: '' },
          { id: 's4', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '', credit: '1600,83' }
        ]
      }
    ]
  },
  // Page 18
  {
    id: 22,
    title: "Ex 18 - Vente Escompte Ferme",
    description: "Escompte ferme déduit directement sur la facture.",
    documents: [
      {
        type: 'INVOICE', title: "Facture 86",
        content: {
          sender: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          receiver: { name: "A.V.I. S.A.", address: ["rue du Collège 5", "5000 NAMUR"], vat: "BE 0895 538 345" },
          details: { number: "86", date: "30/06/XX" },
          lines: [{ qty: 150, desc: "Produit B", pu: "10", total: "1500" }, { qty: "", desc: "Escompte ferme", pu: "", total: "-27" }],
          totals: { bases: [{ rate: "21%", base: "1323", tax: "277,83" }], totalExcl: "1323", totalVat: "277,83", toPay: "1600,83" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.VENTE, defaultDate: "30/06/n",
        solution: [
          { id: 's1', accountNumber: '7000', declTva: '03', codePopsy: '21', label: '', debit: '', credit: '1350' },
          { id: 's2', accountNumber: '6530', declTva: '03(-)', codePopsy: '21', label: '', debit: '27', credit: '' },
          { id: 's3', accountNumber: '4510', declTva: '54', codePopsy: '', label: '', debit: '', credit: '277,83' },
          { id: 's4', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '1600,83', credit: '' }
        ]
      }
    ]
  },
  // Page 19
  {
    id: 23,
    title: "Ex 19 - Achat + Emballages",
    description: "Achat avec frais de transport et emballages consignés.",
    documents: [
      {
        type: 'INVOICE', title: "Facture 960",
        content: {
          sender: { name: "COTUBEX", address: ["rue des Fabriques 27-31", "1400 NIVELLES"], vat: "BE 0861.775.912" },
          receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          lines: [
            { qty: 100, desc: "Produit B", pu: "10", total: "1000" },
            { qty: 1, desc: "Transport", pu: "100", total: "100" },
            { qty: "", desc: "Emballages consignés", pu: "", total: "50" }
          ],
          totals: { bases: [{ rate: "21%", base: "1100", tax: "231" }], totalExcl: "1150 (Total net)", totalVat: "231", toPay: "1381" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.ACHAT, defaultDate: "30/06/n",
        solution: [
          { id: 's1', accountNumber: '6040', declTva: '81', codePopsy: '21M', label: '', debit: '1100', credit: '' },
          { id: 's2', accountNumber: '4050', declTva: 'EX', codePopsy: '', label: '', debit: '50', credit: '' },
          { id: 's3', accountNumber: '4110', declTva: '59', codePopsy: '', label: '', debit: '231', credit: '' },
          { id: 's4', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '', credit: '1381' }
        ]
      }
    ]
  },
  // Page 20
  {
    id: 24,
    title: "Ex 20 - Vente + Emballages",
    description: "Vente avec frais de transport et emballages consignés.",
    documents: [
      {
        type: 'INVOICE', title: "Facture 100",
        content: {
          sender: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          receiver: { name: "A.V.I. S.A.", address: ["rue du Collège 5", "5000 NAMUR"], vat: "BE 0895 538 345" },
          lines: [
            { qty: 100, desc: "Produit B", pu: "10", total: "1000" },
            { qty: 1, desc: "Transport", pu: "100", total: "100" },
            { qty: "", desc: "Emballages consignés", pu: "", total: "50" }
          ],
          totals: { bases: [{ rate: "21%", base: "1100", tax: "231" }], totalExcl: "1150", totalVat: "231", toPay: "1381" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.VENTE, defaultDate: "30/06/n",
        solution: [
          { id: 's1', accountNumber: '7000', declTva: '03', codePopsy: '21', label: '', debit: '', credit: '1100' },
          { id: 's2', accountNumber: '4510', declTva: '54', codePopsy: '', label: '', debit: '', credit: '231' },
          { id: 's3', accountNumber: '4450', declTva: '', codePopsy: '', label: '', debit: '', credit: '50' },
          { id: 's4', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '1381', credit: '' }
        ]
      }
    ]
  },
  // Page 21
  {
    id: 25,
    title: "Ex 21 - Achat + Emballages Vendus",
    description: "Achat avec emballages vendus (non consignés).",
    documents: [
      {
        type: 'INVOICE', title: "Facture 1012",
        content: {
          sender: { name: "COTUBEX", address: ["rue des Fabriques 27-31", "1400 NIVELLES"], vat: "BE 0861.775.912" }, 
          receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          lines: [
            { qty: 100, desc: "Produit B", pu: "10", total: "1000" },
            { qty: 1, desc: "Transport", pu: "100", total: "100" },
            { qty: "", desc: "Emballages vendus", pu: "", total: "50" }
          ],
          totals: { bases: [{ rate: "21%", base: "1150", tax: "241,50" }], totalExcl: "1150", totalVat: "241,50", toPay: "1391,50" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.ACHAT, defaultDate: "30/06/n",
        solution: [
          { id: 's1', accountNumber: '6040', declTva: '81', codePopsy: '21M', label: '', debit: '1150', credit: '' },
          { id: 's2', accountNumber: '4110', declTva: '59', codePopsy: '', label: '', debit: '241,50', credit: '' },
          { id: 's3', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '', credit: '1391,50' }
        ]
      }
    ]
  },
  // Page 22
  {
    id: 26,
    title: "Ex 22 - Vente + Emballages Vendus",
    description: "Vente avec emballages vendus (non consignés).",
    documents: [
      {
        type: 'INVOICE', title: "Facture 115",
        content: {
          sender: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          receiver: { name: "A.V.I. S.A.", address: ["rue du Collège 5", "5000 NAMUR"], vat: "BE 0895 538 345" },
          lines: [
            { qty: 100, desc: "Produit B", pu: "10", total: "1000" },
            { qty: 1, desc: "Transport", pu: "100", total: "100" },
            { qty: "", desc: "Emballages vendus", pu: "", total: "50" }
          ],
          totals: { bases: [{ rate: "21%", base: "1150", tax: "241,50" }], totalExcl: "1150", totalVat: "241,50", toPay: "1391,50" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.VENTE, defaultDate: "30/06/n",
        solution: [
          { id: 's1', accountNumber: '7000', declTva: '21', codePopsy: '21', label: '', debit: '', credit: '1150' },
          { id: 's2', accountNumber: '4510', declTva: '54', codePopsy: '', label: '', debit: '', credit: '241,50' },
          { id: 's3', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '', credit: '1391,50' }
        ]
      }
    ]
  },
  // Page 23
  {
    id: 27,
    title: "Ex 23 - Achat Voiture",
    description: "Achat GOLF VW. Déductibilité TVA 50%.",
    documents: [
      {
        type: 'INVOICE', title: "Facture 120",
        content: {
          sender: { name: "Garage Zebra", address: ["rue de la Panne 14", "7000 MONS"], vat: "BE 0202-239-951" },
          receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          lines: [{ qty: "", desc: "ACHAT GOLF VW", pu: "", total: "20.000" }],
          totals: { bases: [{ rate: "21%", base: "20.000", tax: "4.200" }], totalExcl: "20.000", totalVat: "4.200", toPay: "24.200" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.ACHAT, defaultDate: "29/06/n",
        solution: [
          { id: 's1', accountNumber: '2410', declTva: '83', codePopsy: '21ND', label: '', debit: '22.100', credit: '' },
          { id: 's2', accountNumber: '4110', declTva: '59', codePopsy: '', label: '', debit: '2100', credit: '' },
          { id: 's3', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '', credit: '24200' }
        ]
      }
    ]
  },
  // Page 24
  {
    id: 28,
    title: "Ex 24 - Entretien Voiture",
    description: "Entretien GOLF VW. Déductibilité TVA 50%.",
    documents: [
      {
        type: 'INVOICE', title: "Facture 199",
        content: {
          sender: { name: "Garage Zebra", address: ["rue de la Panne 14", "7000 MONS"], vat: "BE 0202-239-951" },
          receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          lines: [{ qty: "", desc: "Entretien GOLF VW", pu: "", total: "2.000" }],
          totals: { bases: [{ rate: "21%", base: "2.000", tax: "420" }], totalExcl: "2.000", totalVat: "420", toPay: "2.420" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.ACHAT, defaultDate: "30/06/n",
        solution: [
          { id: 's1', accountNumber: '6108', declTva: '82', codePopsy: '21ND', label: '', debit: '2.210', credit: '' },
          { id: 's2', accountNumber: '4110', declTva: '59', codePopsy: '', label: '', debit: '210', credit: '' },
          { id: 's3', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '', credit: '2420' }
        ]
      }
    ]
  },
  // Page 25
  {
    id: 29,
    title: "Ex 25 - Acompte & Facture Finale",
    description: "Facture d'acompte 1000€ + Facture finale 10.000€.",
    documents: [
      {
        type: 'INVOICE', title: "Facture Acompte 160",
        content: {
          sender: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          receiver: { name: "A.V.I. S.A.", address: ["rue du Collège 5", "5000 NAMUR"], vat: "BE 0895 538 345" },
          details: { number: "160", date: "30/06/XX" },
          lines: [{ qty: 1, desc: "FACTURE ACOMPTE", pu: "", total: "1.000" }],
          totals: { bases: [{ rate: "21%", base: "1000", tax: "210" }], totalExcl: "1.000", totalVat: "210", toPay: "1.210" }
        }
      },
      { type: 'NOTE', title: "Info", content: { text: "Facture d'acompte de 1.000 € htva sur total de 10.000 €. Paiement liquide." } },
      {
        type: 'INVOICE', title: "Facture Finale 220",
        content: {
          sender: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          receiver: { name: "A.V.I. S.A.", address: ["rue du Collège 5", "5000 NAMUR"], vat: "BE 0895 538 345" },
          details: { number: "220", date: "31/08/XX" },
          lines: [{ qty: 1, desc: "Facture finale", pu: "", total: "10.000" }, { qty: "", desc: "-Acompte", pu: "", total: "-1.000" }],
          totals: { bases: [{ rate: "21%", base: "9000", tax: "1.890" }], totalExcl: "9.000", totalVat: "1.890", toPay: "10.890" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.VENTE, defaultDate: "30/06/N",
        solution: [
          { id: 's1', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '1210', credit: '' },
          { id: 's2', accountNumber: '4600', declTva: '03', codePopsy: '21', label: '', debit: '', credit: '1000' },
          { id: 's3', accountNumber: '4510', declTva: '54', codePopsy: '', label: '', debit: '', credit: '210' },
        ]
      },
      {
        type: JournalType.CAISSE, defaultDate: "30/06/N",
        solution: [
          { id: 's1', accountNumber: '5700', declTva: '', codePopsy: '', label: '', debit: '1210', credit: '' },
          { id: 's2', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '', credit: '1210' },
        ]
      },
      {
        type: JournalType.VENTE, defaultDate: "31/08/N",
        solution: [
          { id: 's1', accountNumber: '4600', declTva: '03(-)', codePopsy: '21', label: '', debit: '1000', credit: '' },
          { id: 's2', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '10890', credit: '' },
          { id: 's3', accountNumber: '7000', declTva: '03', codePopsy: '21', label: '', debit: '', credit: '10.000' },
          { id: 's4', accountNumber: '4510', declTva: '54', codePopsy: '', label: '', debit: '', credit: '1.890' },
        ]
      }
    ]
  },
  // Page 26
  {
    id: 30,
    title: "Ex 26 - Vente Comptoir",
    description: "Vente au comptoir (TVA 21%) 100€ TVAC.",
    documents: [
      { type: 'NOTE', title: "Énoncé", content: { text: "Vous réalisez une vente le 30/06 au comptoir (TVA 21%) d'un montant de 100 € TVAC.\nLe client vous paie en liquide." } }
    ],
    requiredJournals: [
      {
        type: JournalType.VENTE, defaultDate: "30/06/N",
        solution: [
          { id: 's1', accountNumber: '4000', declTva: '', codePopsy: '', label: 'Client comptoir', debit: '100', credit: '' },
          { id: 's2', accountNumber: '4510', declTva: '54', codePopsy: '', label: '', debit: '', credit: '17,36' },
          { id: 's3', accountNumber: '7000', declTva: '03', codePopsy: '21', label: '', debit: '', credit: '82,64' },
        ]
      },
      {
        type: JournalType.FINANCIER, defaultDate: "30/06/N",
        solution: [
          { id: 's1', accountNumber: '5700', declTva: '', codePopsy: '', label: '', debit: '100', credit: '' },
          { id: 's2', accountNumber: '4000', declTva: '', codePopsy: '', label: '', debit: '', credit: '100' },
        ]
      }
    ]
  },
  // Page 27
  {
    id: 31,
    title: "Ex 27 - Achat Whisky",
    description: "Achat de whisky. TVA non déductible.",
    documents: [
      {
        type: 'INVOICE', title: "Facture 78",
        content: {
          sender: { name: "Distillerie prestigue", address: ["Chée de France 18", "6000 Charleroi"], vat: "BE 0424.850.991" },
          receiver: { name: "SPRL OUTISUD", address: ["Chée Romaine 147", "7500 TOURNAI"], vat: "BE 0415.776.939" },
          lines: [{ qty: 1, desc: "whisky", pu: "150", total: "150" }],
          totals: { bases: [{ rate: "21%", base: "150", tax: "31,5" }], totalExcl: "150", totalVat: "31,5", toPay: "181,50" }
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.ACHAT, defaultDate: "30/06/n",
        solution: [
          { id: 's1', accountNumber: '6168', declTva: '82', codePopsy: '21ND100S', label: '', debit: '181,50', credit: '' },
          { id: 's2', accountNumber: '4400', declTva: '', codePopsy: '', label: '', debit: '', credit: '181,50' },
        ]
      }
    ]
  },
  // Page 28
  {
    id: 32,
    title: "Ex 28 - Loyer",
    description: "Paiement du loyer.",
    documents: [
      {
        type: 'BANK_EXTRACT', title: "Extrait n°396",
        content: {
          account: "068-4567890-02", prevDate: "30/06/XX", prevBalance: "1.530",
          transactions: [{ date: "30/06/XX", desc: "Loyer du bâtiment", amount: "-560" }],
          newDate: "02/07/XX", newBalance: "970"
        }
      }
    ],
    requiredJournals: [
      {
        type: JournalType.FINANCIER, defaultDate: "30/06/n",
        solution: [
          { id: 's1', accountNumber: '6101', declTva: '', codePopsy: '', label: '', debit: '560', credit: '' },
          { id: 's2', accountNumber: '5500', declTva: '', codePopsy: '', label: '', debit: '', credit: '560' },
        ]
      }
    ]
  }
];

        // --- 4. COMPOSANTS (COMPONENTS/*.TSX) ---

        // ----- DocumentViewer Component -----
        const InvoiceViewer = ({ content }) => {
          const senderName = content.sender?.name || "Expéditeur Inconnu";
          const senderAddress = content.sender?.address || [];
          const senderVat = content.sender?.vat || "";
          const receiverName = content.receiver?.name || "Client";
          const receiverAddress = content.receiver?.address || [];
          const receiverVat = content.receiver?.vat || "";
          const detailsNumber = content.details?.number || "?";
          const detailsDate = content.details?.date || "?";
          const detailsPayment = content.details?.paymentInfo || "";

          return (
            <div className="bg-white border border-gray-300 shadow-md p-6 max-w-2xl mx-auto font-serif text-sm relative">
              <div className="absolute top-2 right-2 text-gray-300 text-xs font-sans">DOCUMENT COMPTABLE</div>
              <div className="flex justify-between mb-8">
                <div className="w-1/3">
                  <h3 className="font-bold text-lg uppercase">{senderName}</h3>
                  {senderAddress.map((line, i) => <p key={i}>{line}</p>)}
                  <p className="mt-2 font-mono">{senderVat}</p>
                </div>
                <div className="w-1/3 border-2 border-slate-800 p-2">
                  <p className="text-xs text-gray-500 mb-1">Client :</p>
                  <h3 className="font-bold">{receiverName}</h3>
                  {receiverAddress.map((line, i) => <p key={i}>{line}</p>)}
                  <p className="mt-2 font-mono">{receiverVat}</p>
                </div>
              </div>
              <div className="flex justify-between items-end border-b-2 border-black pb-2 mb-4">
                <div>
                  <p><strong>N° Fac :</strong> {detailsNumber}</p>
                  <p><strong>Date :</strong> {detailsDate}</p>
                </div>
                <div className="text-right italic">{detailsPayment}</div>
              </div>
              <table className="w-full mb-6">
                <thead>
                  <tr className="border-b border-gray-400">
                    <th className="text-left py-1 w-16">Qté</th>
                    <th className="text-left py-1">Libellé</th>
                    <th className="text-right py-1 w-20">P.U.</th>
                    <th className="text-right py-1 w-24">Montant</th>
                  </tr>
                </thead>
                <tbody>
                  {content.lines?.map((line, idx) => (
                    <tr key={idx} className="border-b border-gray-100">
                      <td className="py-1">{line.qty}</td>
                      <td className="py-1">{line.desc}</td>
                      <td className="text-right py-1">{line.pu}</td>
                      <td className="text-right py-1">{line.total}</td>
                    </tr>
                  ))}
                </tbody>
              </table>
              <div className="flex justify-end">
                <div className="w-1/2">
                  <div className="grid grid-cols-3 gap-2 border-t border-black pt-2 text-xs mb-2">
                    <div className="font-bold">Taux</div>
                    <div className="font-bold text-right">Base</div>
                    <div className="font-bold text-right">TVA</div>
                    {content.totals?.bases?.map((base, i) => (
                      <React.Fragment key={i}>
                        <div>{base.rate}</div>
                        <div className="text-right">{base.base}</div>
                        <div className="text-right">{base.tax}</div>
                      </React.Fragment>
                    ))}
                  </div>
                  <div className="flex justify-between font-bold border-t border-gray-300 pt-1">
                    <span>Total HT:</span>
                    <span>{content.totals?.totalExcl}</span>
                  </div>
                  <div className="flex justify-between font-bold">
                    <span>Total TVA:</span>
                    <span>{content.totals?.totalVat}</span>
                  </div>
                  <div className="flex justify-between font-bold text-lg border-t-2 border-black mt-1 pt-1 bg-yellow-50 px-1">
                    <span>A PAYER:</span>
                    <span>{content.totals?.toPay}</span>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        const BankExtractViewer = ({ content }) => {
          return (
            <div className="bg-blue-50 border border-blue-200 shadow-md p-4 max-w-2xl mx-auto font-mono text-sm">
              <div className="flex justify-between border-b-2 border-blue-800 mb-4 pb-2 text-blue-900">
                <h3 className="font-bold">{content.title}</h3>
                <span>Compte: {content.account}</span>
              </div>
              <div className="space-y-2">
                <div className="flex justify-between text-gray-600">
                  <span>Ancien solde au {content.prevDate}</span>
                  <span>{content.prevBalance}</span>
                </div>
                {content.transactions?.map((tx, idx) => (
                   <div key={idx} className="flex justify-between bg-white p-2 border border-blue-100 font-bold">
                     <div className="flex gap-4">
                       <span className="text-gray-500">{tx.date}</span>
                       <span>{tx.desc}</span>
                     </div>
                     <div className={tx.amount.startsWith('-') ? 'text-red-600' : 'text-green-600'}>
                       {tx.amount}
                     </div>
                   </div>
                ))}
                <div className="flex justify-between border-t-2 border-blue-800 pt-2 font-bold text-blue-900">
                  <span>Nouveau solde au {content.newDate}</span>
                  <span>{content.newBalance}</span>
                </div>
              </div>
            </div>
          );
        };

        const NoteViewer = ({ content }) => {
          return (
            <div className="bg-yellow-100 border border-yellow-300 p-4 rounded shadow text-yellow-900 italic text-center mx-auto max-w-xl">
              <p className="whitespace-pre-line font-handwriting">{content.text}</p>
            </div>
          );
        };

        const DocumentViewer = ({ document }) => {
          switch (document.type) {
            case 'INVOICE': return <InvoiceViewer content={document.content} />;
            case 'BANK_EXTRACT': return <BankExtractViewer content={document.content} />;
            case 'NOTE': return <NoteViewer content={document.content} />;
            default: return <div>Document non reconnu</div>;
          }
        };

        // ----- JournalTable Component -----
        const EmptyRow = (id) => ({
          id,
          accountNumber: '',
          declTva: '',
          codePopsy: '',
          label: '',
          debit: '',
          credit: ''
        });

        const JournalTable = ({ type, defaultDate, rows, setRows, showSolution, solutionRows }) => {
          const [journalDate, setJournalDate] = useState(defaultDate);

          useEffect(() => {
            setJournalDate(defaultDate);
          }, [defaultDate]);

          useEffect(() => {
            if (rows.length === 0) {
              setRows([EmptyRow('1'), EmptyRow('2'), EmptyRow('3')]);
            }
          }, []);

          const handleChange = (id, field, value) => {
            const newRows = rows.map(row => row.id === id ? { ...row, [field]: value } : row);
            setRows(newRows);
          };

          const addRow = () => {
            setRows([...rows, EmptyRow(Date.now().toString())]);
          };

          const removeRow = (id) => {
            setRows(rows.filter(r => r.id !== id));
          };

          const getJournalTitle = (t) => {
            switch(t) {
              case JournalType.ACHAT: return "Journal : Achat";
              case JournalType.VENTE: return "Journal : Vente";
              case JournalType.CAISSE: return "Journal : Caisse";
              case JournalType.FINANCIER: return "Journal : Financier";
              case JournalType.OD: return "Journal : Opérations Diverses";
              default: return "Journal";
            }
          };

          return (
            <div className="bg-white rounded-lg shadow-lg overflow-hidden border border-gray-200 my-6">
              <div className="bg-slate-800 text-white p-3 flex justify-between items-center">
                <h3 className="font-bold text-lg">{getJournalTitle(type)}</h3>
                <div className="flex items-center gap-2">
                   <label className="text-sm font-light">Date :</label>
                   <input 
                     type="text" 
                     value={journalDate} 
                     onChange={(e) => setJournalDate(e.target.value)}
                     className="bg-slate-700 text-white px-2 py-1 rounded w-32 text-center text-sm border border-slate-600 focus:outline-none focus:border-yellow-400"
                   />
                </div>
              </div>
              <div className="overflow-x-auto">
                <table className="w-full text-sm">
                  <thead className="bg-gray-100 text-gray-600 font-semibold border-b">
                    <tr>
                      <th className="p-2 w-24 border-r">No de compte</th>
                      <th className="p-2 w-16 border-r">DECL TVA</th>
                      <th className="p-2 w-20 border-r">CODE POPSY</th>
                      <th className="p-2 border-r text-left">Libellé</th>
                      <th className="p-2 w-28 border-r text-right bg-yellow-50/50">Débit</th>
                      <th className="p-2 w-28 text-right bg-blue-50/50">Crédit</th>
                      <th className="p-2 w-10"></th>
                    </tr>
                  </thead>
                  <tbody>
                    {rows.map((row) => (
                      <tr key={row.id} className="border-b hover:bg-gray-50 transition-colors">
                        <td className="p-1 border-r">
                          <input type="text" value={row.accountNumber} onChange={(e) => handleChange(row.id, 'accountNumber', e.target.value)} className="w-full p-1 bg-yellow-100 font-bold text-center focus:ring-2 focus:ring-blue-400 focus:outline-none" placeholder="6040..." />
                        </td>
                        <td className="p-1 border-r">
                          <input type="text" value={row.declTva} onChange={(e) => handleChange(row.id, 'declTva', e.target.value)} className="w-full p-1 bg-yellow-100 text-center font-bold focus:ring-2 focus:ring-blue-400 focus:outline-none" />
                        </td>
                        <td className="p-1 border-r">
                          <input type="text" value={row.codePopsy} onChange={(e) => handleChange(row.id, 'codePopsy', e.target.value)} className="w-full p-1 bg-yellow-100 text-center font-bold focus:ring-2 focus:ring-blue-400 focus:outline-none" />
                        </td>
                        <td className="p-1 border-r">
                          <input type="text" value={row.label} onChange={(e) => handleChange(row.id, 'label', e.target.value)} className="w-full p-1 bg-transparent focus:ring-2 focus:ring-blue-400 focus:outline-none" placeholder="..." />
                        </td>
                        <td className="p-1 border-r bg-yellow-50/30">
                          <input type="text" value={row.debit} onChange={(e) => handleChange(row.id, 'debit', e.target.value)} className="w-full p-1 bg-yellow-100 text-right font-bold focus:ring-2 focus:ring-blue-400 focus:outline-none" />
                        </td>
                        <td className="p-1 bg-blue-50/30">
                          <input type="text" value={row.credit} onChange={(e) => handleChange(row.id, 'credit', e.target.value)} className="w-full p-1 bg-yellow-100 text-right font-bold focus:ring-2 focus:ring-blue-400 focus:outline-none" />
                        </td>
                        <td className="p-1 text-center">
                          <button onClick={() => removeRow(row.id)} className="text-gray-400 hover:text-red-500 transition-colors"><Trash2 size={16} /></button>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
              <div className="bg-gray-50 p-2 flex justify-start border-t">
                <button onClick={addRow} className="flex items-center gap-1 text-xs font-semibold text-blue-600 hover:text-blue-800 px-3 py-1 rounded hover:bg-blue-100 transition-colors"><Plus size={14} /> Ajouter une ligne</button>
              </div>
              {showSolution && (
                <div className="border-t-4 border-green-400 bg-green-50 p-4 animate-in fade-in slide-in-from-top-4 duration-500">
                  <h4 className="flex items-center gap-2 font-bold text-green-800 mb-2"><CheckCircle size={18} /> Solution attendue</h4>
                  <table className="w-full text-xs text-green-900">
                    <thead>
                       <tr className="border-b border-green-200">
                         <th className="text-left w-24">Compte</th>
                         <th className="text-center w-16">TVA</th>
                         <th className="text-center w-20">Popsy</th>
                         <th className="text-right w-24">Débit</th>
                         <th className="text-right w-24">Crédit</th>
                       </tr>
                    </thead>
                    <tbody>
                      {solutionRows.map((s, idx) => (
                        <tr key={idx} className="border-b border-green-100">
                          <td className="font-mono font-bold py-1">{s.accountNumber}</td>
                          <td className="text-center">{s.declTva}</td>
                          <td className="text-center font-bold">{s.codePopsy}</td>
                          <td className="text-right font-mono">{s.debit}</td>
                          <td className="text-right font-mono">{s.credit}</td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              )}
            </div>
          );
        };

        // ----- Reference Tools Components -----
        const Modal = ({ title, onClose, children }) => (
          <div className="fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4">
            <div className="bg-white rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col animate-in fade-in zoom-in-95 duration-200">
              <div className="flex justify-between items-center p-4 border-b">
                <h2 className="text-xl font-bold text-slate-800">{title}</h2>
                <button onClick={onClose} className="p-1 hover:bg-slate-100 rounded-full transition-colors">
                  <X size={24} className="text-slate-500" />
                </button>
              </div>
              <div className="overflow-auto p-6 flex-grow">
                {children}
              </div>
            </div>
          </div>
        );

        const PlanComptableModal = ({ onClose }) => {
          const [search, setSearch] = useState('');
          const filteredAccounts = PLAN_COMPTABLE.filter(item => item.account.includes(search) || item.label.toLowerCase().includes(search.toLowerCase()));

          return (
            <Modal title="Plan Comptable" onClose={onClose}>
              <div className="mb-4 sticky top-0 bg-white pb-2 z-10">
                <div className="relative">
                  <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" size={20} />
                  <input type="text" placeholder="Rechercher un compte (numéro ou libellé)..." value={search} onChange={(e) => setSearch(e.target.value)} className="w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" autoFocus />
                </div>
              </div>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-sm">
                {filteredAccounts.map((item) => (
                  <div key={item.account} className="flex gap-2 hover:bg-blue-50 p-1 rounded border-b border-gray-100">
                    <span className="font-mono font-bold text-blue-800 w-12">{item.account}</span>
                    <span className="text-gray-700">{item.label}</span>
                  </div>
                ))}
                {filteredAccounts.length === 0 && <p className="text-center text-gray-500 py-8 col-span-2">Aucun compte trouvé.</p>}
              </div>
            </Modal>
          );
        };

        const DeclarationTvaModal = ({ onClose }) => {
          const renderBox = (code, label) => (
            <div key={code} className="flex border-b border-gray-200 last:border-0">
              <div className="w-16 bg-gray-100 p-2 font-bold text-center border-r border-gray-200 flex items-center justify-center">{code}</div>
              <div className="p-2 flex-grow text-sm flex items-center">{label}</div>
            </div>
          );
          const renderSection = (title, items, color) => (
            <div className={`border-2 ${color} rounded-lg mb-6 overflow-hidden`}>
              <div className={`${color.replace('border-', 'bg-')}-100 p-2 font-bold text-center border-b ${color}`}>{title}</div>
              <div className="bg-white">{items.map(item => renderBox(item.code, item.label))}</div>
            </div>
          );
          return (
            <Modal title="Structure de la Déclaration TVA" onClose={onClose}>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  {renderSection("CADRE II : Opérations à la sortie", DECLARATION_TVA.cadreII, "border-blue-500")}
                  {renderSection("CADRE III : Opérations à l'entrée", DECLARATION_TVA.cadreIII, "border-green-500")}
                </div>
                <div>
                  {renderSection("CADRE IV : Taxes Dues", DECLARATION_TVA.cadreIV, "border-red-500")}
                  {renderSection("CADRE V : Taxes Déductibles", DECLARATION_TVA.cadreV, "border-purple-500")}
                  {renderSection("CADRE VI : Solde", DECLARATION_TVA.cadreVI, "border-orange-500")}
                </div>
              </div>
            </Modal>
          );
        };

        const CodesPopsyModal = ({ onClose }) => {
          return (
            <Modal title="Codes TVA pour le logiciel POPSY" onClose={onClose}>
              <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div>
                  <h3 className="font-bold text-lg mb-2 text-center bg-yellow-100 p-2 rounded">Achats et Notes de Crédit sur Achats</h3>
                  <table className="w-full text-sm border-collapse">
                    <thead>
                      <tr className="bg-gray-50">
                        <th className="border p-2 text-left">Code</th>
                        <th className="border p-2 w-16 text-center">TVA</th>
                        <th className="border p-2 text-left">Libellé</th>
                      </tr>
                    </thead>
                    <tbody>
                      {CODES_POPSY.achats.map((code, idx) => (
                        <tr key={idx} className="hover:bg-gray-50">
                          <td className="border p-2 font-bold bg-yellow-200 text-center">{code.code}</td>
                          <td className="border p-2 text-center bg-yellow-200">{code.tva}</td>
                          <td className="border p-2 bg-yellow-100">{code.label}</td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
                <div>
                  <h3 className="font-bold text-lg mb-2 text-center bg-orange-100 p-2 rounded">Ventes et Notes de Crédit sur Ventes</h3>
                  <table className="w-full text-sm border-collapse mb-8">
                    <thead>
                      <tr className="bg-gray-50">
                        <th className="border p-2 text-left">Code</th>
                        <th className="border p-2 w-16 text-center">TVA</th>
                        <th className="border p-2 text-left">Libellé</th>
                      </tr>
                    </thead>
                    <tbody>
                      {CODES_POPSY.ventes.map((code, idx) => (
                        <tr key={idx} className="hover:bg-gray-50">
                          <td className="border p-2 font-bold bg-yellow-200 text-center">{code.code}</td>
                          <td className="border p-2 text-center bg-yellow-200">{code.tva}</td>
                          <td className="border p-2 bg-yellow-100">{code.label}</td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                  <div className="border-2 border-slate-800 p-4 rounded-lg bg-white shadow-sm">
                     <h4 className="font-bold mb-2 underline">Notes Importantes :</h4>
                     <ul className="space-y-3">
                       {CODES_POPSY.divers.map((item, idx) => (
                         <li key={idx} className="flex gap-3 items-start">
                           <span className="font-bold bg-yellow-300 px-2 py-0.5 rounded text-xs">{item.code}</span>
                           <span className="text-sm">{item.label}</span>
                         </li>
                       ))}
                     </ul>
                  </div>
                </div>
              </div>
            </Modal>
          );
        };

        // ----- App Component -----

        const LoginScreen = ({ onLogin }) => {
          const [email, setEmail] = useState('');
          const [error, setError] = useState('');

          const handleSubmit = (e) => {
            e.preventDefault();
            if (!email.toLowerCase().endsWith('@istlm.org') || email.length < 12) {
              setError("L'adresse email doit être au format prénom.nom@istlm.org");
              return;
            }
            onLogin(email);
          };

          return (
            <div className="min-h-screen bg-slate-900 flex items-center justify-center p-4">
              <div className="bg-white rounded-xl shadow-2xl max-w-2xl w-full overflow-hidden flex flex-col md:flex-row">
                <div className="bg-yellow-500 md:w-1/3 p-8 flex flex-col justify-between text-slate-900">
                  <div>
                    <BookOpen size={48} className="mb-4" />
                    <h1 className="text-2xl font-bold leading-tight">Exercices de comptabilité POPSY</h1>
                  </div>
                  <div className="mt-8 text-sm font-semibold opacity-80">Institut Saint-Luc Frameries</div>
                </div>
                <div className="p-8 md:w-2/3">
                  <h2 className="text-xl font-bold mb-4 text-slate-800">Bienvenue</h2>
                  <p className="text-slate-600 mb-6 text-sm leading-relaxed">
                    Il s'agit d'un exercice basé sur l'enregistrement des écritures comptables dans les différents journaux (achat, vente, financier et opération diverse), il a été réalisé pour les élèves de l'Institut Saint-Luc à Frameries option Technicien en comptabilité par Mr Depret.
                  </p>
                  <form onSubmit={handleSubmit} className="space-y-4">
                    <div>
                      <label htmlFor="email" className="block text-sm font-medium text-slate-700 mb-1">Adresse Email (Institut)</label>
                      <input id="email" type="email" required placeholder="prénom.nom@istlm.org" value={email} onChange={(e) => { setEmail(e.target.value); setError(''); }} className={`w-full p-3 border rounded-lg focus:ring-2 focus:outline-none transition-colors ${error ? 'border-red-300 focus:ring-red-200' : 'border-gray-300 focus:ring-yellow-200'}`} />
                      {error && <div className="flex items-center gap-2 text-red-600 text-xs mt-2"><AlertCircle size={14} /><span>{error}</span></div>}
                    </div>
                    <button type="submit" className="w-full bg-slate-800 text-white font-bold py-3 rounded-lg hover:bg-slate-900 transition-colors flex items-center justify-center gap-2"><span>Commencer l'exercice</span><LogIn size={18} /></button>
                  </form>
                  <div className="mt-8 pt-4 border-t border-gray-100 text-center"><p className="text-xs text-slate-400 italic">Réalisé par Mr Depret</p></div>
                </div>
              </div>
            </div>
          );
        };

        const CompletionScreen = ({ userEmail, onRestart, onPrint }) => {
          return (
            <div className="min-h-screen bg-slate-100 flex flex-col items-center justify-center p-4 print:hidden">
              <div className="bg-white p-10 rounded-2xl shadow-xl text-center max-w-2xl w-full">
                <div className="inline-flex items-center justify-center w-24 h-24 bg-yellow-100 rounded-full text-yellow-500 mb-6"><Trophy size={48} strokeWidth={1.5} /></div>
                <h1 className="text-4xl font-bold text-slate-800 mb-2">Félicitations !</h1>
                <p className="text-slate-600 text-lg mb-8">Vous avez terminé tous les exercices, <span className="font-bold text-slate-800">{userEmail.split('@')[0]}</span>.</p>
                <div className="flex flex-col sm:flex-row gap-4 justify-center">
                  <button onClick={onPrint} className="flex items-center justify-center gap-2 px-6 py-4 bg-slate-800 text-white rounded-xl hover:bg-slate-900 transition-all font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-1"><Printer size={20} /> Imprimer le rapport complet</button>
                  <button onClick={onRestart} className="flex items-center justify-center gap-2 px-6 py-4 bg-white border-2 border-slate-200 text-slate-700 rounded-xl hover:border-slate-300 hover:bg-slate-50 transition-all font-semibold"><RotateCcw size={20} /> Recommencer les exercices</button>
                </div>
              </div>
            </div>
          );
        };

        const PrintView = ({ userEmail, allUserAnswers }) => {
          return (
            <div className="hidden print:block p-8 bg-white text-black print-color-adjust-exact">
              <div className="mb-8 border-b-2 border-black pb-4">
                <h1 className="text-3xl font-bold">Rapport d'exercices comptables POPSY</h1>
                <p className="text-lg mt-2">Élève : {userEmail}</p>
                <p className="text-sm text-gray-500">Institut Saint-Luc Frameries - {new Date().toLocaleDateString()}</p>
              </div>
              {LEVELS.map((level) => (
                <div key={level.id} className="mb-8 break-inside-avoid page-break-after-auto border-b border-gray-200 pb-8">
                  <h2 className="text-xl font-bold bg-gray-100 p-2 mb-4 border-l-4 border-slate-800">Niveau {level.id} : {level.title}</h2>
                  <div className="space-y-6">
                    {level.requiredJournals.map((journalTemplate, idx) => {
                      const userRows = allUserAnswers[level.id]?.[idx] || [];
                      return (
                        <div key={idx} className="border border-gray-300 rounded p-4 break-inside-avoid">
                          <h3 className="font-bold text-lg mb-2">{journalTemplate.type} - {journalTemplate.defaultDate}</h3>
                          <div className="mb-4">
                            <h4 className="text-sm font-bold text-blue-800 mb-1">Votre réponse :</h4>
                            {userRows.length > 0 ? (
                              <table className="w-full text-xs border-collapse border border-gray-400 mb-2">
                                <thead>
                                  <tr className="bg-gray-100">
                                    <th className="border border-gray-400 p-1 w-20">Compte</th>
                                    <th className="border border-gray-400 p-1 w-16">TVA</th>
                                    <th className="border border-gray-400 p-1 w-20">Popsy</th>
                                    <th className="border border-gray-400 p-1">Libellé</th>
                                    <th className="border border-gray-400 p-1 text-right w-24">Débit</th>
                                    <th className="border border-gray-400 p-1 text-right w-24">Crédit</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  {userRows.map((r, rIdx) => (
                                    <tr key={rIdx}>
                                      <td className="border border-gray-400 p-1 font-mono">{r.accountNumber}</td>
                                      <td className="border border-gray-400 p-1 text-center">{r.declTva}</td>
                                      <td className="border border-gray-400 p-1 text-center">{r.codePopsy}</td>
                                      <td className="border border-gray-400 p-1">{r.label}</td>
                                      <td className="border border-gray-400 p-1 text-right bg-yellow-50">{r.debit}</td>
                                      <td className="border border-gray-400 p-1 text-right bg-blue-50">{r.credit}</td>
                                    </tr>
                                  ))}
                                </tbody>
                              </table>
                            ) : <p className="text-xs italic text-gray-500">Aucune donnée saisie.</p>}
                          </div>
                          <div>
                            <h4 className="text-sm font-bold text-green-800 mb-1">Correction :</h4>
                            <table className="w-full text-xs border-collapse border border-gray-400">
                              <thead>
                                <tr className="bg-green-50">
                                  <th className="border border-gray-400 p-1 w-20">Compte</th>
                                  <th className="border border-gray-400 p-1 w-16">TVA</th>
                                  <th className="border border-gray-400 p-1 w-20">Popsy</th>
                                  <th className="border border-gray-400 p-1 text-right w-24">Débit</th>
                                  <th className="border border-gray-400 p-1 text-right w-24">Crédit</th>
                                </tr>
                              </thead>
                              <tbody>
                                {journalTemplate.solution.map((s, sIdx) => (
                                  <tr key={sIdx}>
                                    <td className="border border-gray-400 p-1 font-mono font-bold">{s.accountNumber}</td>
                                    <td className="border border-gray-400 p-1 text-center">{s.declTva}</td>
                                    <td className="border border-gray-400 p-1 text-center">{s.codePopsy}</td>
                                    <td className="border border-gray-400 p-1 text-right font-mono">{s.debit}</td>
                                    <td className="border border-gray-400 p-1 text-right font-mono">{s.credit}</td>
                                  </tr>
                                ))}
                              </tbody>
                            </table>
                          </div>
                        </div>
                      );
                    })}
                  </div>
                </div>
              ))}
            </div>
          );
        };

        const App = () => {
          const [isAuthenticated, setIsAuthenticated] = useState(false);
          const [userEmail, setUserEmail] = useState('');
          const [currentLevelIdx, setCurrentLevelIdx] = useState(0);
          const [showSolution, setShowSolution] = useState(false);
          const [isCompleted, setIsCompleted] = useState(false);
          const [activeModal, setActiveModal] = useState('NONE');
          const [allUserAnswers, setAllUserAnswers] = useState({});

          const currentLevel = LEVELS[currentLevelIdx];

          const handleLogin = (email) => {
            setUserEmail(email);
            setIsAuthenticated(true);
          };

          const handleRestart = () => {
            setCurrentLevelIdx(0);
            setIsCompleted(false);
            setShowSolution(false);
            setAllUserAnswers({});
            window.scrollTo({ top: 0, behavior: 'smooth' });
          };

          const handlePrint = () => {
            window.print();
          };

          const nextLevel = () => {
            setShowSolution(false);
            if (currentLevelIdx < LEVELS.length - 1) {
              setCurrentLevelIdx(prev => prev + 1);
              window.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
              setIsCompleted(true);
            }
          };

          const prevLevel = () => {
            if (currentLevelIdx > 0) {
              setShowSolution(false);
              setCurrentLevelIdx(prev => prev - 1);
              window.scrollTo({ top: 0, behavior: 'smooth' });
            }
          };

          const updateJournalRows = (levelId, journalIndex, rows) => {
            setAllUserAnswers(prev => ({
              ...prev,
              [levelId]: { ...(prev[levelId] || {}), [journalIndex]: rows }
            }));
          };

          if (!isAuthenticated) return <LoginScreen onLogin={handleLogin} />;
          if (isCompleted) return <><CompletionScreen userEmail={userEmail} onRestart={handleRestart} onPrint={handlePrint} /><PrintView userEmail={userEmail} allUserAnswers={allUserAnswers} /></>;

          const getCurrentJournalRows = (journalIndex) => {
            return allUserAnswers[currentLevel.id]?.[journalIndex] || [];
          };

          return (
            <>
              <div className="min-h-screen flex flex-col font-sans print:hidden">
                <header className="bg-slate-900 text-white p-4 sticky top-0 z-50 shadow-lg">
                  <div className="container mx-auto flex justify-between items-center">
                    <div className="flex items-center gap-3">
                      <div className="bg-yellow-500 p-2 rounded text-slate-900"><BookOpen size={24} /></div>
                      <div>
                        <h1 className="text-xl font-bold tracking-tight">Compta POPSY</h1>
                        <div className="flex items-center gap-2 text-xs text-slate-400"><span>{userEmail}</span><span className="w-1 h-1 rounded-full bg-slate-500"></span><span>Institut Saint-Luc</span></div>
                      </div>
                    </div>
                    <div className="flex items-center gap-4">
                      <button onClick={prevLevel} disabled={currentLevelIdx === 0} className={`p-2 rounded-full transition-colors ${currentLevelIdx === 0 ? 'text-slate-700 cursor-not-allowed' : 'hover:bg-slate-700 text-white'}`}><ChevronLeft /></button>
                      <div className="text-center"><span className="block text-xs text-slate-400 uppercase tracking-widest">Niveau</span><span className="font-bold text-lg">{currentLevel.id} / {LEVELS.length}</span></div>
                      <button onClick={nextLevel} className="p-2 rounded-full hover:bg-slate-700 text-white transition-colors"><ChevronRight /></button>
                    </div>
                  </div>
                </header>

                <main className="flex-grow container mx-auto p-4 md:p-8 flex flex-col lg:flex-row gap-8 pb-32">
                  <div className="lg:w-1/2 flex flex-col gap-6">
                    <div className="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                      <h2 className="text-2xl font-bold text-slate-800 mb-2">{currentLevel.title}</h2>
                      <p className="text-slate-600 mb-4">{currentLevel.description}</p>
                      <div className="h-1 w-20 bg-yellow-500 rounded"></div>
                    </div>
                    <div className="space-y-6">
                      {currentLevel.documents.map((doc, idx) => (
                        <div key={idx} className="relative group">
                          <div className="absolute -left-3 top-1/2 -translate-y-1/2 w-1 h-full bg-slate-200 rounded-l group-hover:bg-blue-400 transition-colors"></div>
                          <DocumentViewer document={doc} />
                        </div>
                      ))}
                    </div>
                  </div>
                  <div className="lg:w-1/2">
                    <div className="space-y-8">
                      {currentLevel.requiredJournals.map((journalTemplate, idx) => (
                        <JournalTable
                          key={`${currentLevel.id}-${idx}`}
                          type={journalTemplate.type}
                          defaultDate={journalTemplate.defaultDate}
                          rows={getCurrentJournalRows(idx)}
                          setRows={(rows) => updateJournalRows(currentLevel.id, idx, rows)}
                          showSolution={showSolution}
                          solutionRows={journalTemplate.solution}
                        />
                      ))}
                    </div>
                  </div>
                </main>

                <div className="fixed bottom-0 left-0 w-full bg-white border-t border-gray-200 p-3 shadow-2xl z-40">
                  <div className="container mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
                    <div className="flex gap-2 w-full md:w-auto overflow-x-auto pb-1 md:pb-0">
                       <button onClick={() => setActiveModal('PLAN')} className="flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-md text-sm font-semibold transition-colors whitespace-nowrap"><List size={16} /> Plan Comptable</button>
                       <button onClick={() => setActiveModal('TVA')} className="flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-md text-sm font-semibold transition-colors whitespace-nowrap"><FileText size={16} /> Déclaration TVA</button>
                       <button onClick={() => setActiveModal('CODES')} className="flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-md text-sm font-semibold transition-colors whitespace-nowrap"><Grid size={16} /> Codes Popsy</button>
                    </div>
                    <div className="flex gap-4">
                      <button onClick={() => setShowSolution(!showSolution)} className={`flex items-center gap-2 px-6 py-3 font-bold rounded-lg shadow transition-all ${showSolution ? 'bg-slate-800 text-white hover:bg-slate-900' : 'bg-yellow-500 text-slate-900 hover:bg-yellow-400'}`}><Eye size={18} /> {showSolution ? 'Masquer' : 'Valider'}</button>
                      {currentLevelIdx === LEVELS.length - 1 && <button onClick={nextLevel} className="flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-lg transition-colors animate-pulse">Terminer <ChevronRight size={18} /></button>}
                    </div>
                  </div>
                </div>
              </div>

              {activeModal === 'PLAN' && <PlanComptableModal onClose={() => setActiveModal('NONE')} />}
              {activeModal === 'TVA' && <DeclarationTvaModal onClose={() => setActiveModal('NONE')} />}
              {activeModal === 'CODES' && <CodesPopsyModal onClose={() => setActiveModal('NONE')} />}
              <PrintView userEmail={userEmail} allUserAnswers={allUserAnswers} />
            </>
          );
        };

        // --- 5. RENDER ---
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>